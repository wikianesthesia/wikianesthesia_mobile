mw.loader.implement("ext.visualEditor.mwtransclusion@g0eb3",function($,jQuery,require,module){ve.dm.MWTransclusionNode=function VeDmMWTransclusionNode(){ve.dm.MWTransclusionNode.super.apply(this,arguments);ve.dm.GeneratedContentNode.call(this);ve.dm.FocusableNode.call(this);this.partsList=null;this.connect(this,{attributeChange:'onAttributeChange'});};OO.inheritClass(ve.dm.MWTransclusionNode,ve.dm.LeafNode);OO.mixinClass(ve.dm.MWTransclusionNode,ve.dm.GeneratedContentNode);OO.mixinClass(ve.dm.MWTransclusionNode,ve.dm.FocusableNode);ve.dm.MWTransclusionNode.static.name='mwTransclusion';ve.dm.MWTransclusionNode.static.matchTagNames=null;ve.dm.MWTransclusionNode.static.matchRdfaTypes=['mw:Transclusion'];ve.dm.MWTransclusionNode.static.allowedRdfaTypes=null;ve.dm.MWTransclusionNode.static.matchFunction=function(){return!0;};ve.dm.MWTransclusionNode.static.enableAboutGrouping=!0;ve.dm.MWTransclusionNode.static.preserveHtmlAttributes=function(attribute){return['data-parsoid','id'].
indexOf(attribute)!==-1;};ve.dm.MWTransclusionNode.static.getHashObject=function(dataElement){return{type:dataElement.type,mw:dataElement.attributes.mw};};ve.dm.MWTransclusionNode.static.isDiffComparable=function(element,other){function getTemplateNames(parts){return parts.map(function(part){return part.template?part.template.target.wt:'';}).join('|');}return ve.dm.MWTransclusionNode.super.static.isDiffComparable.call(this,element,other)&&getTemplateNames(element.attributes.mw.parts)===getTemplateNames(other.attributes.mw.parts);};ve.dm.MWTransclusionNode.static.inlineType='mwTransclusionInline';ve.dm.MWTransclusionNode.static.blockType='mwTransclusionBlock';ve.dm.MWTransclusionNode.static.cellType='mwTransclusionTableCell';ve.dm.MWTransclusionNode.static.toDataElement=function(domElements,converter){var mwDataJSON=domElements[0].getAttribute('data-mw'),mwData=mwDataJSON?JSON.parse(mwDataJSON):{},isInline=this.isHybridInline(domElements,converter),type=isInline?this.inlineType:this.
blockType;var dataElement={type:type,attributes:{mw:mwData,originalMw:mwDataJSON}};if(domElements.length===1&&['td','th'].indexOf(domElements[0].nodeName.toLowerCase())!==-1){dataElement.type=this.cellType;ve.dm.TableCellableNode.static.setAttributes(dataElement.attributes,domElements);}if(!domElements[0].getAttribute('data-ve-no-generated-contents')){this.storeGeneratedContents(dataElement,domElements,converter.getStore());}return dataElement;};ve.dm.MWTransclusionNode.static.toDomElements=function(dataElement,doc,converter){var els,value,store=converter.getStore(),originalMw=dataElement.attributes.originalMw,originalDomElements=store.value(dataElement.originalDomElementsHash);function wrapTextNode(node){if(node.nodeType===Node.TEXT_NODE){var wrapper=doc.createElement('span');wrapper.appendChild(node);return wrapper;}return node;}if(originalDomElements&&originalMw&&ve.compare(dataElement.attributes.mw,JSON.parse(originalMw))){els=ve.copyDomElements(originalDomElements,doc);}else{if(
converter.doesModeNeedRendering()&&(value=store.value(store.hashOfValue(null,OO.getHash([this.getHashObjectForRendering(dataElement),undefined]))))){els=ve.copyDomElements(value,doc);els[0]=wrapTextNode(els[0]);}else if(originalDomElements){els=[doc.createElement(originalDomElements[0].nodeName)];}else if(dataElement.type===this.cellType){els=[doc.createElement(dataElement.attributes.style==='header'?'th':'td')];}else{els=[doc.createElement('span')];}els[0].setAttribute('typeof','mw:Transclusion');els[0].setAttribute('data-mw',JSON.stringify(dataElement.attributes.mw));}if(converter.isForClipboard()){if(els[0].tagName==='LINK'||els[0].tagName==='META'||els[0].tagName==='STYLE'){var span=doc.createElement('span');span.setAttribute('typeof','mw:Transclusion');span.setAttribute('data-mw',els[0].getAttribute('data-mw'));els[0]=span;}if(els[0].innerHTML===''){els[0].appendChild(doc.createTextNode('\u00a0'));}els[0].setAttribute('data-ve-no-generated-contents',!0);for(var i=1;i<els.length;
i++){els[i]=wrapTextNode(els[i]);els[i].setAttribute('data-ve-ignore','true');}}else if(converter.isForPreview()){var modelNode=ve.dm.nodeFactory.createFromElement(dataElement);modelNode.setDocument(converter.internalList.getDocument());var viewNode=ve.ce.nodeFactory.createFromModel(modelNode);if(!viewNode.hasRendering()){viewNode.onSetup();viewNode.$element.append(viewNode.createInvisibleIcon()).attr('title',dataElement.attributes.text);els=viewNode.$element.toArray();viewNode.destroy();return els;}}return els;};ve.dm.MWTransclusionNode.static.describeChanges=function(attributeChanges){var param,paramChanges,descriptions=[ve.msg('visualeditor-changedesc-mwtransclusion')];function getLabel(par){if(par&&par.wt!==undefined){return par.wt;}return par;}if(attributeChanges.mw.from.parts.length===1&&attributeChanges.mw.to.parts.length===1){var params={};for(param in attributeChanges.mw.from.parts[0].template.params){params[param]={from:getLabel(attributeChanges.mw.from.parts[0].template.
params[param])};}for(param in attributeChanges.mw.to.parts[0].template.params){params[param]=ve.extendObject({to:getLabel(attributeChanges.mw.to.parts[0].template.params[param])},params[param]);}for(param in params){var from=(params[param].from||'').trim()||undefined,to=(params[param].to||'').trim()||undefined;if(from!==to){var change=this.describeChange(param,{from:from,to:to});if(change){if(!paramChanges){paramChanges=document.createElement('ul');descriptions.push(paramChanges);}var listItem=document.createElement('li');if(typeof change==='string'){listItem.appendChild(document.createTextNode(change));}else{change.forEach(function(node){listItem.appendChild(node);});}paramChanges.appendChild(listItem);}}}}return descriptions;};ve.dm.MWTransclusionNode.static.cloneElement=function(){var clone=ve.dm.MWTransclusionNode.super.static.cloneElement.apply(this,arguments);delete clone.attributes.originalMw;return clone;};ve.dm.MWTransclusionNode.static.escapeParameter=function(param){var input
=param,output='',inNowiki=!1,bracketStack=0,linkStack=0;while(input.length>0){var match=input.match(/(?:\[\[)|(?:\]\])|(?:\{\{)|(?:\}\})|\|+|<\/?nowiki>|<nowiki\s*\/>/);if(!match){output+=input;break;}output+=input.slice(0,match.index);input=input.slice(match.index+match[0].length);if(inNowiki){if(match[0]==='</nowiki>'){inNowiki=!1;output+=match[0];}else{output+=match[0];}}else{var needsNowiki=!0;if(match[0]==='<nowiki>'){inNowiki=!0;needsNowiki=!1;}else if(match[0]==='</nowiki>'||match[0].match(/<nowiki\s*\/>/)){needsNowiki=!1;}else if(match[0].match(/(?:\[\[)/)){linkStack++;needsNowiki=!1;}else if(match[0].match(/(?:\]\])/)){if(linkStack>0){linkStack--;needsNowiki=!1;}}else if(match[0].match(/(?:\{\{)/)){bracketStack++;needsNowiki=!1;}else if(match[0].match(/(?:\}\})/)){if(bracketStack>0){bracketStack--;needsNowiki=!1;}}else if(match[0].match(/\|+/)){if(bracketStack>0||linkStack>0){needsNowiki=!1;}}if(needsNowiki){output+='<nowiki>'+match[0]+
'</nowiki>';}else{output+=match[0];}}}return output;};ve.dm.MWTransclusionNode.static.getWikitext=function(content){var i,len,part,template,param,wikitext='';if(content.params){content={parts:[{template:content}]};}for(i=0,len=content.parts.length;i<len;i++){part=content.parts[i];if(part.template){template=part.template;wikitext+='{{'+template.target.wt;for(param in template.params){wikitext+='|'+param+'='+this.escapeParameter(template.params[param].wt);}wikitext+='}}';}else{wikitext+=part;}}return wikitext;};ve.dm.MWTransclusionNode.prototype.onAttributeChange=function(key){if(key==='mw'){this.partsList=null;}};ve.dm.MWTransclusionNode.prototype.isSingleTemplate=function(allowedTemplates){var templateNS=mw.config.get('wgNamespaceIds').template,parts=this.getPartsList();function normalizeTemplateTitle(name){var title=mw.Title.newFromText(name,templateNS);return title?title.getPrefixedText():name;}var isSingle=parts.length===1;if(!isSingle||!allowedTemplates){return isSingle;}var
singlePart=parts[0];if(!singlePart.templatePage){return!1;}if(typeof allowedTemplates==='string'){allowedTemplates=[allowedTemplates];}return allowedTemplates.some(function(template){return singlePart.templatePage===normalizeTemplateTitle(template);});};ve.dm.MWTransclusionNode.prototype.getPartsList=function(){if(!this.partsList){this.partsList=[];var content=this.getAttribute('mw');for(var i=0;i<content.parts.length;i++){var part=content.parts[i];if(part.template){var href=part.template.target.href,page=href?mw.libs.ve.normalizeParsoidResourceName(href):null;this.partsList.push({template:part.template.target.wt,templatePage:page});}else{this.partsList.push({content:part});}}}return this.partsList;};ve.dm.MWTransclusionNode.prototype.getWikitext=function(){return this.constructor.static.getWikitext(this.getAttribute('mw'));};ve.dm.modelRegistry.register(ve.dm.MWTransclusionNode);ve.dm.MWTransclusionBlockNode=function VeDmMWTransclusionBlockNode(){ve.dm.MWTransclusionBlockNode.super
.apply(this,arguments);};OO.inheritClass(ve.dm.MWTransclusionBlockNode,ve.dm.MWTransclusionNode);ve.dm.MWTransclusionBlockNode.static.matchTagNames=[];ve.dm.MWTransclusionBlockNode.static.name='mwTransclusionBlock';ve.dm.modelRegistry.register(ve.dm.MWTransclusionBlockNode);ve.dm.MWTransclusionInlineNode=function VeDmMWTransclusionInlineNode(){ve.dm.MWTransclusionInlineNode.super.apply(this,arguments);};OO.inheritClass(ve.dm.MWTransclusionInlineNode,ve.dm.MWTransclusionNode);ve.dm.MWTransclusionInlineNode.static.matchTagNames=[];ve.dm.MWTransclusionInlineNode.static.name='mwTransclusionInline';ve.dm.MWTransclusionInlineNode.static.isContent=!0;ve.dm.modelRegistry.register(ve.dm.MWTransclusionInlineNode);ve.dm.MWTransclusionTableCellNode=function VeDmMWTransclusionTableCellNode(){ve.dm.MWTransclusionTableCellNode.super.apply(this,arguments);ve.dm.TableCellableNode.call(this);};OO.inheritClass(ve.dm.MWTransclusionTableCellNode,ve.dm.MWTransclusionNode);OO.mixinClass(ve.dm.
MWTransclusionTableCellNode,ve.dm.TableCellableNode);ve.dm.MWTransclusionTableCellNode.static.matchTagNames=[];ve.dm.MWTransclusionTableCellNode.static.name='mwTransclusionTableCell';ve.dm.modelRegistry.register(ve.dm.MWTransclusionTableCellNode);ve.ce.MWTransclusionNode=function VeCeMWTransclusionNode(model,config){ve.ce.MWTransclusionNode.super.call(this,model,config);ve.ce.GeneratedContentNode.call(this);ve.ce.FocusableNode.call(this);};OO.inheritClass(ve.ce.MWTransclusionNode,ve.ce.LeafNode);OO.mixinClass(ve.ce.MWTransclusionNode,ve.ce.GeneratedContentNode);OO.mixinClass(ve.ce.MWTransclusionNode,ve.ce.FocusableNode);ve.ce.MWTransclusionNode.static.name='mwTransclusion';ve.ce.MWTransclusionNode.static.primaryCommandName='transclusion';ve.ce.MWTransclusionNode.static.iconWhenInvisible='puzzle';ve.ce.MWTransclusionNode.static.getTemplatePartDescriptions=function(model){return model.getPartsList().map(this.getTemplatePartDescription);};ve.ce.MWTransclusionNode.static.
getTemplatePartDescription=function(part){if(part.templatePage){return mw.Title.newFromText(part.templatePage).getRelativeText(mw.config.get('wgNamespaceIds').template);}else if(part.template){return part.template;}};ve.ce.MWTransclusionNode.static.getDescription=function(model){return this.getTemplatePartDescriptions(model).filter(function(desc){return desc;}).join(ve.msg('comma-separator'));};ve.ce.MWTransclusionNode.static.filterRendering=function(contentNodes){if(!contentNodes.length){return;}var whitespaceRegex=new RegExp('^['+ve.dm.Converter.static.whitespaceList+']+$');contentNodes=contentNodes.filter(function(node){var dataMw=node&&node.nodeType===Node.ELEMENT_NODE&&node.hasAttribute('data-mw')&&JSON.parse(node.getAttribute('data-mw'));return!dataMw||!dataMw.autoGenerated;});contentNodes.forEach(function(node){if(node.nodeType===Node.ELEMENT_NODE){mw.libs.ve.stripParsoidFallbackIds(node);}});function isWhitespaceNode(node){return node&&node.nodeType===Node.TEXT_NODE&&!!node.
data.match(whitespaceRegex);}while(isWhitespaceNode(contentNodes[0])){contentNodes.shift();}while(isWhitespaceNode(contentNodes[contentNodes.length-1])){contentNodes.pop();}if(contentNodes.length===1&&contentNodes[0].nodeName.toLowerCase()==='p'){contentNodes=Array.prototype.slice.call(contentNodes[0].childNodes);}return contentNodes;};ve.ce.MWTransclusionNode.prototype.generateContents=function(config){var xhr,deferred=ve.createDeferred();xhr=ve.init.target.parseWikitextFragment((config&&config.wikitext)||this.model.getWikitext(),!0,this.getModel().getDocument()).done(this.onParseSuccess.bind(this,deferred)).fail(this.onParseError.bind(this,deferred));return deferred.promise({abort:xhr.abort});};ve.ce.MWTransclusionNode.prototype.onParseSuccess=function(deferred,response){if(ve.getProp(response,'visualeditor','result')!=='success'){this.onParseError(deferred);return;}var contentNodes=$.parseHTML(response.visualeditor.content,this.model&&this.getModelHtmlDocument())||[];deferred.
resolve(this.constructor.static.filterRendering(contentNodes));};ve.ce.MWTransclusionNode.prototype.render=function(generatedContents){ve.ce.GeneratedContentNode.prototype.render.call(this,generatedContents);};ve.ce.MWTransclusionNode.prototype.onSetup=function(){ve.ce.MWTransclusionNode.super.prototype.onSetup.apply(this,arguments);this.$element.addClass('ve-ce-mwTransclusionNode');};ve.ce.MWTransclusionNode.prototype.getRenderedDomElements=function(){var elements=ve.ce.GeneratedContentNode.prototype.getRenderedDomElements.apply(this,arguments);if(this.model&&this.getModelHtmlDocument()){ve.init.platform.linkCache.styleParsoidElements($(elements),this.getModelHtmlDocument());}return elements;};ve.ce.MWTransclusionNode.prototype.filterRenderedDomElements=function(domElements){var selector='style:not([data-mw-deduplicate^="TemplateStyles:"]), link:not([rel="mw-deduplicated-inline-style"][href^="mw-data:TemplateStyles:"])';return $(domElements).find(selector).addBack(selector).remove().
end().end().toArray();};ve.ce.MWTransclusionNode.prototype.onParseError=function(deferred){deferred.reject();};ve.ce.nodeFactory.register(ve.ce.MWTransclusionNode);ve.ce.MWTransclusionBlockNode=function VeCeMWTransclusionBlockNode(model){ve.ce.MWTransclusionBlockNode.super.call(this,model);};OO.inheritClass(ve.ce.MWTransclusionBlockNode,ve.ce.MWTransclusionNode);ve.ce.MWTransclusionBlockNode.static.name='mwTransclusionBlock';ve.ce.MWTransclusionBlockNode.static.tagName='div';ve.ce.nodeFactory.register(ve.ce.MWTransclusionBlockNode);ve.ce.MWTransclusionInlineNode=function VeCeMWTransclusionInlineNode(model){ve.ce.MWTransclusionInlineNode.super.call(this,model);};OO.inheritClass(ve.ce.MWTransclusionInlineNode,ve.ce.MWTransclusionNode);ve.ce.MWTransclusionInlineNode.static.name='mwTransclusionInline';ve.ce.MWTransclusionInlineNode.static.tagName='span';ve.ce.nodeFactory.register(ve.ce.MWTransclusionInlineNode);ve.ce.MWTransclusionTableCellNode=function VeCeMWTransclusionTableCellNode(
model){ve.ce.MWTransclusionTableCellNode.super.call(this,model);ve.ce.TableCellableNode.call(this);};OO.inheritClass(ve.ce.MWTransclusionTableCellNode,ve.ce.MWTransclusionNode);OO.mixinClass(ve.ce.MWTransclusionTableCellNode,ve.ce.TableCellableNode);ve.ce.MWTransclusionTableCellNode.static.name='mwTransclusionTableCell';ve.ce.nodeFactory.register(ve.ce.MWTransclusionTableCellNode);(function(){var hasOwn=Object.hasOwnProperty,specCache={};ve.dm.MWTransclusionModel=function VeDmMWTransclusionModel(doc){OO.EventEmitter.call(this);this.doc=doc;this.parts=[];this.uid=0;this.templateDataApiRequests=[];this.changeQueue=[];};OO.mixinClass(ve.dm.MWTransclusionModel,OO.EventEmitter);ve.dm.MWTransclusionModel.prototype.insertTransclusionNode=function(surfaceFragment,forceType){var model=this,deferred=ve.createDeferred(),baseNodeClass=ve.dm.MWTransclusionNode;function insertNode(isInline,generatedContents){var type=isInline?baseNodeClass.static.inlineType:baseNodeClass.static.blockType,data=[{type
:type,attributes:{mw:model.getPlainObject()}},{type:'/'+type}];if(generatedContents){var nodeClass=ve.dm.modelRegistry.lookup(type);var store=surfaceFragment.getDocument().getStore();var hash=OO.getHash([nodeClass.static.getHashObjectForRendering(data[0]),undefined]);store.hash(generatedContents,hash);}surfaceFragment.insertContent(data);deferred.resolve();}if(forceType){insertNode(forceType==='inline');}else{ve.init.target.parseWikitextFragment(baseNodeClass.static.getWikitext(this.getPlainObject()),!0,surfaceFragment.getDocument()).then(function(response){if(ve.getProp(response,'visualeditor','result')==='success'){var contentNodes=$.parseHTML(response.visualeditor.content,surfaceFragment.getDocument().getHtmlDocument())||[];contentNodes=ve.ce.MWTransclusionNode.static.filterRendering(contentNodes);insertNode(baseNodeClass.static.isHybridInline(contentNodes,ve.dm.converter),contentNodes);}else{insertNode(!0);}},function(){insertNode(!0);});}return deferred.promise();};ve.dm.
MWTransclusionModel.prototype.updateTransclusionNode=function(surfaceModel,node){var obj=this.getPlainObject();if(obj!==null){surfaceModel.getLinearFragment(node.getOuterRange(),!0).changeAttributes({mw:obj});}else{surfaceModel.getLinearFragment(node.getOuterRange(),!0).removeContent();}};ve.dm.MWTransclusionModel.prototype.load=function(data){var deferred,promises=[];if(data.params&&data.target){data={parts:[{template:data}]};}if(Array.isArray(data.parts)){for(var i=0;i<data.parts.length;i++){var part=data.parts[i];if(part.template){deferred=ve.createDeferred();promises.push(deferred.promise());this.changeQueue.push({add:ve.dm.MWTemplateModel.newFromData(this,part.template),deferred:deferred});}else if(typeof part==='string'){deferred=ve.createDeferred();promises.push(deferred.promise());this.changeQueue.push({add:new ve.dm.MWTransclusionContentModel(this,part),deferred:deferred});}}setTimeout(this.processChangeQueue.bind(this));}return ve.promiseAll(promises);};ve.dm.
MWTransclusionModel.prototype.resolveChangeQueue=function(queue){var i,resolveQueue=[];for(i=0;i<queue.length;i++){var item=queue[i],remove=0;if(item.add instanceof ve.dm.MWTemplateModel){var title=item.add.getTitle();if(hasOwn.call(specCache,title)&&specCache[title]){item.add.getSpec().setTemplateData(specCache[title]);}}var index=item.index;var existing=this.parts.indexOf(item.add);if(existing!==-1){this.removePart(item.add);if(index&&existing+1<index){index--;}}if(index===undefined&&item.remove){index=this.parts.indexOf(item.remove);if(index!==-1){remove=1;}}if(index===undefined||index===-1){index=this.parts.length;}this.parts.splice(index,remove,item.add);if(item.add){item.add.connect(this,{change:['emit','change']});}if(item.remove){item.remove.disconnect(this);}this.emit('replace',item.remove||null,item.add,index);if(item.deferred){resolveQueue.push(item.deferred);}}this.emit('change');for(i=0;i<resolveQueue.length;i++){resolveQueue[i].resolve();}};ve.dm.MWTransclusionModel.
prototype.processChangeQueue=function(){var templateNamespaceId=mw.config.get('wgNamespaceIds').template,titles=[];if(!this.changeQueue.length){return;}var queue=this.changeQueue.slice();this.changeQueue.length=0;for(var i=0;i<queue.length;i++){var item=queue[i];if(item.add instanceof ve.dm.MWTemplateModel){var title=item.add.getTitle(),mwTitle=title?mw.Title.newFromText(title,templateNamespaceId):null;if(mwTitle&&mwTitle.namespace===templateNamespaceId&&!hasOwn.call(specCache,title)&&titles.indexOf(title)===-1){titles.push(title);}}}if(!titles.length){setTimeout(this.resolveChangeQueue.bind(this,queue));return;}this.templateDataApiRequests.push(this.callTemplateDataApi(titles,queue));};ve.dm.MWTransclusionModel.prototype.callTemplateDataApi=function(titles,queue){var xhr=ve.init.target.getContentApi(this.doc).get({action:'templatedata',titles:titles,lang:mw.config.get('wgUserLanguage'),includeMissingTitles:'1',redirects:'1'}).done(this.cacheTemplateDataApiResponse.bind(this));xhr.
always(this.markRequestAsDone.bind(this,xhr),this.resolveChangeQueue.bind(this,queue));return xhr;};ve.dm.MWTransclusionModel.prototype.cacheTemplateDataApiResponse=function(data){if(!data||!data.pages){return;}for(var id in data.pages){var title=data.pages[id].title;if(data.pages[id].missing){var missingTitle={};missingTitle[title]={missing:!0};ve.init.platform.linkCache.setMissing(missingTitle);}else if(data.pages[id].notemplatedata&&!OO.isPlainObject(data.pages[id].params)){specCache[title]=null;}else{specCache[title]=data.pages[id];}}var aliasMap=data.redirects||[];if(data.normalized){ve.batchPush(aliasMap,data.normalized);}for(var i=0;i<aliasMap.length;i++){if(hasOwn.call(specCache,aliasMap[i].to)){specCache[aliasMap[i].from]=specCache[aliasMap[i].to];}}};ve.dm.MWTransclusionModel.prototype.markRequestAsDone=function(apiPromise){var index=this.templateDataApiRequests.indexOf(apiPromise);if(index!==-1){this.templateDataApiRequests.splice(index,1);}};ve.dm.MWTransclusionModel.
prototype.abortAllApiRequests=function(){for(var i=0;i<this.templateDataApiRequests.length;i++){this.templateDataApiRequests[i].abort();}this.templateDataApiRequests.length=0;};ve.dm.MWTransclusionModel.prototype.getPlainObject=function(){var parts=[];for(var i=0;i<this.parts.length;i++){var part=this.parts[i];var serialization=part.serialize();if(serialization!==undefined&&serialization!==''){parts.push(serialization);}}return parts.length?{parts:parts}:null;};ve.dm.MWTransclusionModel.prototype.getUniquePartId=function(){return this.uid++;};ve.dm.MWTransclusionModel.prototype.replacePart=function(remove,add){var deferred=ve.createDeferred();if(!(remove instanceof ve.dm.MWTransclusionPartModel)||!(add instanceof ve.dm.MWTransclusionPartModel)){throw new Error('Invalid transclusion part');}this.changeQueue.push({remove:remove,add:add,deferred:deferred});setTimeout(this.processChangeQueue.bind(this));return deferred.promise();};ve.dm.MWTransclusionModel.prototype.addPart=function(part,
index){var deferred=ve.createDeferred();if(!(part instanceof ve.dm.MWTransclusionPartModel)){throw new Error('Invalid transclusion part');}this.changeQueue.push({add:part,index:index,deferred:deferred});setTimeout(this.processChangeQueue.bind(this));return deferred.promise();};ve.dm.MWTransclusionModel.prototype.removePart=function(part){var index=this.parts.indexOf(part);if(index!==-1){this.parts.splice(index,1);part.disconnect(this);this.emit('replace',part,null);}};ve.dm.MWTransclusionModel.prototype.getParts=function(){return this.parts;};ve.dm.MWTransclusionModel.prototype.getPartFromId=function(id){var partId=id.split('/')[0];for(var i=0;i<this.parts.length;i++){if(this.parts[i].getId()===partId){return this.parts[i];}}return null;};ve.dm.MWTransclusionModel.prototype.getIndex=function(model){var parts=this.parts,index=0;for(var i=0;i<parts.length;i++){var part=parts[i];if(part===model){return index;}index++;if(part instanceof ve.dm.MWTemplateModel){var names=part.
getOrderedParameterNames();for(var j=0;j<names.length;j++){if(part.getParameter(names[j])===model){return index;}index++;}}}return-1;};ve.dm.MWTransclusionModel.prototype.addPromptedParameters=function(){for(var i=0;i<this.parts.length;i++){this.parts[i].addPromptedParameters();}};ve.dm.MWTransclusionModel.prototype.reset=function(){this.parts=[];this.uid=0;this.templateDataApiRequests=[];this.changeQueue=[];};mw.log.deprecate(ve.dm.MWTransclusionModel.prototype,'abortRequests',ve.dm.MWTransclusionModel.prototype.abortAllApiRequests,'Use "abortAllApiRequests" instead.');}());ve.dm.MWTransclusionPartModel=function VeDmMWTransclusionPartModel(transclusion){OO.EventEmitter.call(this);this.transclusion=transclusion;this.id='part_'+this.transclusion.getUniquePartId();};OO.mixinClass(ve.dm.MWTransclusionPartModel,OO.EventEmitter);ve.dm.MWTransclusionPartModel.prototype.getTransclusion=function(){return this.transclusion;};ve.dm.MWTransclusionPartModel.prototype.getId=function(){return this.
id;};ve.dm.MWTransclusionPartModel.prototype.remove=function(){this.transclusion.removePart(this);};ve.dm.MWTransclusionPartModel.prototype.serialize=function(){return undefined;};ve.dm.MWTransclusionPartModel.prototype.addPromptedParameters=function(){return 0;};ve.dm.MWTransclusionPartModel.prototype.containsValuableData=function(){return!1;};ve.dm.MWTransclusionContentModel=function VeDmMWTransclusionContentModel(transclusion,wikitext){ve.dm.MWTransclusionContentModel.super.call(this,transclusion);this.wikitext=wikitext||'';};OO.inheritClass(ve.dm.MWTransclusionContentModel,ve.dm.MWTransclusionPartModel);ve.dm.MWTransclusionContentModel.prototype.setWikitext=function(wikitext){if(this.wikitext!==wikitext){this.wikitext=wikitext;this.emit('change');}};ve.dm.MWTransclusionContentModel.prototype.serialize=function(){return this.wikitext;};ve.dm.MWTransclusionContentModel.prototype.containsValuableData=function(){return this.wikitext!=='';};ve.dm.MWTemplateSpecModel=function
VeDmMWTemplateSpecModel(template){this.template=template;this.seenParameterNames={};this.templateData={notemplatedata:!0,params:{}};this.aliases={};this.fillFromTemplate();};OO.initClass(ve.dm.MWTemplateSpecModel);ve.dm.MWTemplateSpecModel.static.getLocalValue=function(stringOrObject,languageCode){return stringOrObject&&typeof stringOrObject==='object'?OO.ui.getLocalValue(stringOrObject,languageCode):stringOrObject;};ve.dm.MWTemplateSpecModel.prototype.setTemplateData=function(data){if(!data||!ve.isPlainObject(data)){return;}this.templateData=data;if(!this.templateData.params){this.templateData.params={};}var resolveAliases=!1;for(var primaryName in this.templateData.params){this.seenParameterNames[primaryName]=!0;var aliases=this.getParameterAliases(primaryName);for(var i=0;i<aliases.length;i++){var alias=aliases[i];this.aliases[alias]=primaryName;if(alias in this.seenParameterNames){resolveAliases=!0;}}}if(resolveAliases){var primaryNames={};for(var name in this.
seenParameterNames){primaryNames[this.getPrimaryParameterName(name)]=!0;}this.seenParameterNames=primaryNames;}};ve.dm.MWTemplateSpecModel.prototype.fillFromTemplate=function(){for(var name in this.template.getParameters()){if(name&&!this.isKnownParameterOrAlias(name)){this.seenParameterNames[name]=!0;}}};ve.dm.MWTemplateSpecModel.prototype.getLabel=function(){var title=this.template.getTitle();if(title){try{title=new mw.Title(title).getRelativeText(mw.config.get('wgNamespaceIds').template);}catch(e){}}return title||this.template.getTarget().wt;};ve.dm.MWTemplateSpecModel.prototype.getDescription=function(languageCode){return this.constructor.static.getLocalValue(this.templateData.description||null,languageCode);};ve.dm.MWTemplateSpecModel.prototype.isDocumented=function(){return!this.templateData.notemplatedata;};ve.dm.MWTemplateSpecModel.prototype.getDocumentedParameterOrder=function(){return Array.isArray(this.templateData.paramOrder)?this.templateData.paramOrder.slice():Object.
keys(this.templateData.params);};ve.dm.MWTemplateSpecModel.prototype.getUndocumentedParameterNames=function(){var documentedParameters=this.templateData.params;return this.getKnownParameterNames().filter(function(name){return!(name in documentedParameters);});};ve.dm.MWTemplateSpecModel.prototype.getCanonicalParameterOrder=function(){var undocumentedParameters=this.getUndocumentedParameterNames();undocumentedParameters.sort(function(a,b){var aIsNaN=isNaN(a),bIsNaN=isNaN(b);if(aIsNaN&&bIsNaN){return a<b?-1:a===b?0:1;}if(aIsNaN){return 1;}if(bIsNaN){return-1;}return a-b;});return this.getDocumentedParameterOrder().concat(undocumentedParameters);};ve.dm.MWTemplateSpecModel.prototype.isKnownParameterOrAlias=function(name){return name in this.seenParameterNames||name in this.aliases;};ve.dm.MWTemplateSpecModel.prototype.isParameterAlias=function(name){return name in this.aliases;};ve.dm.MWTemplateSpecModel.prototype.isParameterDocumented=function(name){return name in this.templateData.
params||name in this.aliases;};ve.dm.MWTemplateSpecModel.prototype.getParameterLabel=function(name,languageCode){var param=this.templateData.params[this.getPrimaryParameterName(name)];return this.constructor.static.getLocalValue(param&&param.label||name,languageCode);};ve.dm.MWTemplateSpecModel.prototype.getParameterDescription=function(name,languageCode){var param=this.templateData.params[this.getPrimaryParameterName(name)];return this.constructor.static.getLocalValue(param&&param.description||null,languageCode);};ve.dm.MWTemplateSpecModel.prototype.getParameterSuggestedValues=function(name){var param=this.templateData.params[this.getPrimaryParameterName(name)];return param&&param.suggestedvalues||[];};ve.dm.MWTemplateSpecModel.prototype.getParameterDefaultValue=function(name){var param=this.templateData.params[this.getPrimaryParameterName(name)];return param&&param.default||'';};ve.dm.MWTemplateSpecModel.prototype.getParameterExampleValue=function(name,languageCode){var param=this.
templateData.params[this.getPrimaryParameterName(name)];return this.constructor.static.getLocalValue(param&&param.example||null,languageCode);};ve.dm.MWTemplateSpecModel.prototype.getParameterAutoValue=function(name){var param=this.templateData.params[this.getPrimaryParameterName(name)];return param&&param.autovalue||'';};ve.dm.MWTemplateSpecModel.prototype.getParameterType=function(name){var param=this.templateData.params[this.getPrimaryParameterName(name)];return param&&param.type||'string';};ve.dm.MWTemplateSpecModel.prototype.getParameterAliases=function(name){var param=this.templateData.params[this.getPrimaryParameterName(name)];return param&&param.aliases||[];};ve.dm.MWTemplateSpecModel.prototype.getPrimaryParameterName=function(name){return this.aliases[name]||name;};ve.dm.MWTemplateSpecModel.prototype.isParameterRequired=function(name){var param=this.templateData.params[this.getPrimaryParameterName(name)];return!!(param&&param.required);};ve.dm.MWTemplateSpecModel.prototype.
isParameterSuggested=function(name){var param=this.templateData.params[this.getPrimaryParameterName(name)];return!!(param&&param.suggested);};ve.dm.MWTemplateSpecModel.prototype.isParameterDeprecated=function(name){var param=this.templateData.params[this.getPrimaryParameterName(name)];return!!(param&&(param.deprecated||typeof param.deprecated==='string'));};ve.dm.MWTemplateSpecModel.prototype.getParameterDeprecationDescription=function(name){var param=this.templateData.params[this.getPrimaryParameterName(name)];return param&&typeof param.deprecated==='string'?param.deprecated:'';};ve.dm.MWTemplateSpecModel.prototype.getKnownParameterNames=function(){return Object.keys(this.seenParameterNames);};ve.dm.MWTemplateSpecModel.prototype.getParameterSets=function(){return this.templateData.sets||[];};ve.dm.MWTemplateSpecModel.prototype.getMaps=function(){return this.templateData.maps||{};};ve.dm.MWTemplateModel=function VeDmMWTemplateModel(transclusion,target){ve.dm.MWTemplateModel.super.call(
this,transclusion);this.target=target;this.title=target.href?mw.libs.ve.normalizeParsoidResourceName(target.href):null;this.orderedParameterNames=null;this.params={};this.spec=new ve.dm.MWTemplateSpecModel(this);this.originalData=null;};OO.inheritClass(ve.dm.MWTemplateModel,ve.dm.MWTransclusionPartModel);ve.dm.MWTemplateModel.newFromData=function(transclusion,data){var template=new ve.dm.MWTemplateModel(transclusion,data.target);for(var key in data.params){template.addParameter(new ve.dm.MWParameterModel(template,key,data.params[key].wt));}template.setOriginalData(data);return template;};ve.dm.MWTemplateModel.newFromName=function(transclusion,name){var title,templateNs=mw.config.get('wgNamespaceIds').template;if(name instanceof mw.Title){title=name;name=title.getRelativeText(templateNs);}else{title=mw.Title.newFromText(name,templateNs);}if(title!==null){var href=title.getPrefixedText();return new ve.dm.MWTemplateModel(transclusion,{href:href,wt:name});}return null;};ve.dm.
MWTemplateModel.prototype.getTarget=function(){return this.target;};ve.dm.MWTemplateModel.prototype.getTitle=function(){return this.title;};ve.dm.MWTemplateModel.prototype.getSpec=function(){return this.spec;};ve.dm.MWTemplateModel.prototype.getParameters=function(){return this.params;};ve.dm.MWTemplateModel.prototype.getParameter=function(name){return this.params[name];};ve.dm.MWTemplateModel.prototype.hasParameter=function(name){return this.getOriginalParameterName(name)in this.params;};ve.dm.MWTemplateModel.prototype.getOriginalParameterName=function(name){if(name in this.params){return name;}var aliases=this.spec.getParameterAliases(name);for(var i=0;i<aliases.length;i++){if(aliases[i]in this.params){return aliases[i];}}return this.spec.getPrimaryParameterName(name);};ve.dm.MWTemplateModel.prototype.getAllParametersOrdered=function(){var spec=this.spec,parameters=spec.getCanonicalParameterOrder();for(var name in this.params){if(spec.isParameterAlias(name)){parameters.splice(
parameters.indexOf(spec.getPrimaryParameterName(name)),1,name);}}if(''in this.params){parameters.push('');}return parameters;};ve.dm.MWTemplateModel.prototype.getOrderedParameterNames=function(){if(!this.orderedParameterNames){var params=this.params;this.orderedParameterNames=this.getAllParametersOrdered().filter(function(name){return name in params;});}return this.orderedParameterNames;};ve.dm.MWTemplateModel.prototype.getParameterFromId=function(id){for(var name in this.params){if(this.params[name].getId()===id){return this.params[name];}}return null;};ve.dm.MWTemplateModel.prototype.addParameter=function(param){var name=param.getName();if(name in this.params){return;}this.orderedParameterNames=null;this.params[name]=param;this.spec.fillFromTemplate();param.connect(this,{change:['emit','change']});this.emit('add',param);this.emit('change');};ve.dm.MWTemplateModel.prototype.removeParameter=function(param){if(param){this.orderedParameterNames=null;delete this.params[param.getName()];
param.disconnect(this);this.emit('remove',param);this.emit('change');}};ve.dm.MWTemplateModel.prototype.addPromptedParameters=function(){var addedCount=0,params=this.params,spec=this.spec,names=spec.getKnownParameterNames();for(var i=0;i<names.length;i++){var name=names[i];var foundAlias=spec.getParameterAliases(name).some(function(alias){return alias in params;});if(!foundAlias&&!params[name]&&(spec.isParameterRequired(name)||spec.isParameterSuggested(name))){this.addParameter(new ve.dm.MWParameterModel(this,names[i]));addedCount++;}}return addedCount;};ve.dm.MWTemplateModel.prototype.setOriginalData=function(data){this.originalData=data;};ve.dm.MWTemplateModel.prototype.serialize=function(){var origData=this.originalData||{},origParams=origData.params||{},template={target:this.target,params:{}},spec=this.spec,params=this.params;for(var name in params){if(name===''){continue;}if(params[name].getValue()===''&&!Object.prototype.hasOwnProperty.call(origParams,name)&&!spec.
isParameterRequired(name)){continue;}var origName=params[name].getOriginalName();template.params[origName]=ve.extendObject({},origParams[origName],{wt:params[name].getValue()});}template=ve.extendObject({},origData,template);return{template:template};};ve.dm.MWTemplateModel.prototype.containsValuableData=function(){var params=this.params;return Object.keys(params).some(function(name){if(!name){return!1;}var param=params[name],value=param.getValue();return value&&value!==param.getAutoValue()&&value!==param.getDefaultValue();});};ve.dm.MWTemplatePlaceholderModel=function VeDmMWTemplatePlaceholderModel(){ve.dm.MWTemplatePlaceholderModel.super.apply(this,arguments);};OO.inheritClass(ve.dm.MWTemplatePlaceholderModel,ve.dm.MWTransclusionPartModel);ve.dm.MWParameterModel=function VeDmMWParameterModel(template,name,value){OO.EventEmitter.call(this);this.template=template;this.originalName=name;this.name=typeof name==='string'?name.trim():'';this.value=value||'';this.id=this.template.getId()
+'/'+this.name;};OO.mixinClass(ve.dm.MWParameterModel,OO.EventEmitter);ve.dm.MWParameterModel.prototype.isRequired=function(){return this.template.getSpec().isParameterRequired(this.name);};ve.dm.MWParameterModel.prototype.isSuggested=function(){return this.template.getSpec().isParameterSuggested(this.name);};ve.dm.MWParameterModel.prototype.isDeprecated=function(){return this.template.getSpec().isParameterDeprecated(this.name);};ve.dm.MWParameterModel.prototype.isDocumented=function(){return this.template.getSpec().isParameterDocumented(this.name);};ve.dm.MWParameterModel.prototype.getTemplate=function(){return this.template;};ve.dm.MWParameterModel.prototype.getId=function(){return this.id;};ve.dm.MWParameterModel.prototype.getName=function(){return this.name;};ve.dm.MWParameterModel.prototype.getOriginalName=function(){return this.originalName;};ve.dm.MWParameterModel.prototype.getValue=function(){return this.value||this.getAutoValue()||'';};ve.dm.MWParameterModel.prototype.
getSuggestedValues=function(){return this.template.getSpec().getParameterSuggestedValues(this.name);};ve.dm.MWParameterModel.prototype.getDefaultValue=function(){return this.template.getSpec().getParameterDefaultValue(this.name);};ve.dm.MWParameterModel.prototype.getExampleValue=function(){return this.template.getSpec().getParameterExampleValue(this.name);};ve.dm.MWParameterModel.prototype.getAutoValue=function(){return this.template.getSpec().getParameterAutoValue(this.name);};ve.dm.MWParameterModel.prototype.getType=function(){return this.template.getSpec().getParameterType(this.name);};ve.dm.MWParameterModel.prototype.setValue=function(value){if(this.value!==value){this.value=value;this.emit('change');}};ve.dm.MWParameterModel.prototype.remove=function(){this.template.removeParameter(this);};ve.ui.MWDismissibleMessageWidget=function VeUiMWDismissibleMessageWidget(config){config.label=mw.message(config.messageKey).parseDom();ve.ui.MWDismissibleMessageWidget.super.call(this,config);ve
.targetLinksToNewWindow(this.$label[0]);this.messageKey=config.messageKey;var dismissButton=new OO.ui.ButtonWidget({icon:'close',framed:!1,title:mw.msg('visualeditor-dismissible-message-close')}).connect(this,{click:'onDismissClick'});this.$element.addClass('ve-ui-dismissibleMessageWidget').prepend(dismissButton.$element);var hidden=!!mw.storage.get(this.getStorageKey());this.toggle(!hidden);};OO.inheritClass(ve.ui.MWDismissibleMessageWidget,OO.ui.MessageWidget);ve.ui.MWDismissibleMessageWidget.static.storageKeyPrefix='mwe-visualeditor-hide-';ve.ui.MWDismissibleMessageWidget.prototype.getStorageKey=function(){return this.constructor.static.storageKeyPrefix+this.messageKey;};ve.ui.MWDismissibleMessageWidget.prototype.onDismissClick=function(){mw.storage.set(this.getStorageKey(),'1');this.toggle(!1);this.emit('close');};ve.ui.MWParameterCheckboxInputWidget=function VeUiMWParameterCheckboxInputWidget(){ve.ui.MWParameterCheckboxInputWidget.parent.apply(this,arguments);};OO.
inheritClass(ve.ui.MWParameterCheckboxInputWidget,OO.ui.CheckboxInputWidget);ve.ui.MWParameterCheckboxInputWidget.prototype.getValue=function(){return this.isSelected()?'1':'0';};ve.ui.MWParameterCheckboxInputWidget.prototype.setValue=function(value){return this.setSelected(value==='1');};ve.ui.MWParameterSearchWidget=function VeUiMWParameterSearchWidget(template,config){config=ve.extendObject({placeholder:ve.msg('visualeditor-parameter-input-placeholder'),limit:3},config);ve.ui.MWParameterSearchWidget.super.call(this,config);this.template=template;this.index=[];this.showAll=!!config.showAll;this.limit=config.limit||null;this.template.connect(this,{add:'buildIndex',remove:'buildIndex'});this.getResults().connect(this,{choose:'onSearchResultsChoose'});this.$element.addClass('ve-ui-mwParameterSearchWidget');this.query.$input.attr('aria-label',ve.msg('visualeditor-parameter-input-placeholder'));this.buildIndex();};OO.inheritClass(ve.ui.MWParameterSearchWidget,OO.ui.SearchWidget);ve.ui.
MWParameterSearchWidget.prototype.onQueryChange=function(){ve.ui.MWParameterSearchWidget.super.prototype.onQueryChange.call(this);this.addResults();};ve.ui.MWParameterSearchWidget.prototype.onSearchResultsChoose=function(item){if(item instanceof ve.ui.MWParameterResultWidget){this.emit('choose',item.getData().name);}else if(item instanceof ve.ui.MWMoreParametersResultWidget){this.showAll=!0;this.addResults();this.emit('showAll');}};ve.ui.MWParameterSearchWidget.prototype.buildIndex=function(){var spec=this.template.getSpec(),knownParams=spec.getKnownParameterNames();this.index.length=0;for(var i=0;i<knownParams.length;i++){var name=knownParams[i];if(this.template.hasParameter(name)){continue;}var label=spec.getParameterLabel(name),aliases=spec.getParameterAliases(name),description=spec.getParameterDescription(name);this.index.push({text:[label,description].join(' ').toLowerCase(),names:[name].concat(aliases).join('|').toLowerCase(),name:name,label:label,aliases:aliases,description:
description,deprecated:spec.isParameterDeprecated(name)});}this.onQueryChange();};ve.ui.MWParameterSearchWidget.prototype.addResults=function(){var textMatch,nameMatch,remainder,exactMatch=!1,value=this.query.getValue().trim().replace(/[={|}]+/g,''),query=value.toLowerCase(),hasQuery=!!query.length,items=[];this.results.clearItems();for(var i=0;i<this.index.length;i++){var item=this.index[i];if(hasQuery){textMatch=item.text.indexOf(query)!==-1;nameMatch=item.names.indexOf(query)!==-1;}if(!hasQuery||textMatch||nameMatch){if(item.deprecated&&query!==item.name&&item.aliases.indexOf(query)===-1){continue;}items.push(new ve.ui.MWParameterResultWidget({data:item}));if(hasQuery&&nameMatch&&item.names.split('|').indexOf(query)!==-1){exactMatch=!0;}}if(!hasQuery&&!this.showAll&&items.length>=this.limit){remainder=this.index.length-i;break;}}if(hasQuery&&!exactMatch&&value.length&&!this.template.hasParameter(value)){items.unshift(new ve.ui.MWParameterResultWidget({data:{name:value,label:
value,aliases:[],isUnknown:!0}}));}if(!items.length){items.push(new ve.ui.MWNoParametersResultWidget({data:{},disabled:!0}));}else if(remainder){items.push(new ve.ui.MWMoreParametersResultWidget({data:{remainder:remainder}}));}this.results.addItems(items);if(hasQuery){this.results.highlightItem(this.results.findFirstSelectableItem());}};ve.ui.MWParameterResultWidget=function VeUiMWParameterResultWidget(config){config=ve.extendObject({icon:'parameter'},config);ve.ui.MWParameterResultWidget.super.call(this,config);this.$element.addClass('ve-ui-mwParameterResultWidget');this.setLabel(this.buildLabel());};OO.inheritClass(ve.ui.MWParameterResultWidget,OO.ui.DecoratedOptionWidget);ve.ui.MWParameterResultWidget.prototype.buildLabel=function(){var $label=$('<div>').addClass('ve-ui-mwParameterResultWidget-label').text(this.data.label),$names=$('<div>').addClass('ve-ui-mwParameterResultWidget-names'),$description=$('<div>').addClass('ve-ui-mwParameterResultWidget-description').text(this.data
.description||'');if(this.data.isUnknown){$description.addClass('ve-ui-mwParameterResultWidget-unknown').text(ve.msg('visualeditor-parameter-search-unknown'));}if(this.data.name&&this.data.name!==this.data.label){$names.append($('<span>').addClass('ve-ui-mwParameterResultWidget-name').text(this.data.name));}for(var i=0;i<this.data.aliases.length;i++){if(this.data.aliases[i]===this.data.label){continue;}$names.append($('<span>').addClass('ve-ui-mwParameterResultWidget-name ve-ui-mwParameterResultWidget-alias').text(this.data.aliases[i]));}return $label.add($names).add($description);};ve.ui.MWMoreParametersResultWidget=function VeUiMWMoreParametersResultWidget(config){config=ve.extendObject({icon:'parameter-set'},config);ve.ui.MWMoreParametersResultWidget.super.call(this,config);this.$element.addClass('ve-ui-mwMoreParametersResultWidget');this.setLabel(this.buildLabel());};OO.inheritClass(ve.ui.MWMoreParametersResultWidget,OO.ui.DecoratedOptionWidget);ve.ui.MWMoreParametersResultWidget.
prototype.buildLabel=function(){return $('<div>').addClass('ve-ui-mwMoreParametersResultWidget-label').text(ve.msg('visualeditor-parameter-search-more',this.data.remainder));};ve.ui.MWNoParametersResultWidget=function VeUiMWNoParametersResultWidget(config){ve.ui.MWNoParametersResultWidget.super.call(this,config);this.$element.addClass('ve-ui-mwNoParametersResultWidget');this.setLabel(this.buildLabel());};OO.inheritClass(ve.ui.MWNoParametersResultWidget,OO.ui.OptionWidget);ve.ui.MWNoParametersResultWidget.prototype.buildLabel=function(){return $('<div>').addClass('ve-ui-mwNoParametersResultWidget-label').text(ve.msg('visualeditor-parameter-search-no-unused'));};ve.ui.MWTemplateTitleInputWidget=function VeUiMWTemplateTitleInputWidget(config){config=ve.extendObject({},{namespace:mw.config.get('wgNamespaceIds').template,addQueryInput:!1},config);ve.ui.MWTemplateTitleInputWidget.super.call(this,config);this.showTemplateDescriptions=this.showDescriptions;this.showDescriptions=!1;this.
descriptions={};this.$element.addClass('ve-ui-mwTemplateTitleInputWidget');};OO.inheritClass(ve.ui.MWTemplateTitleInputWidget,mw.widgets.TitleInputWidget);ve.ui.MWTemplateTitleInputWidget.prototype.getApiParams=function(query){var params=ve.ui.MWTemplateTitleInputWidget.super.prototype.getApiParams.call(this,query);if(mw.config.get('wgVisualEditorConfig').cirrusSearchLookup){ve.extendObject(params,{generator:'search',gsrsearch:params.gpssearch,gsrnamespace:params.gpsnamespace,gsrlimit:params.gpslimit});var endsWithAlpha;try{endsWithAlpha=new RegExp('[0-9a-z\\p{L}\\p{N}]$','iu');}catch(e){endsWithAlpha=/[0-9a-z\xC0-\uFFFF]$/i;}if(endsWithAlpha.test(params.gsrsearch)){params.gsrsearch+='*';}if(this.showRedirectTargets){params.gsrprop='redirecttitle';}delete params.gpssearch;delete params.gpsnamespace;delete params.gpslimit;}return params;};ve.ui.MWTemplateTitleInputWidget.prototype.getLookupRequest=function(){var widget=this,originalResponse,templateDataMessage=mw.message(
'templatedata-doc-subpage'),templateDataInstalled=templateDataMessage.exists(),templateDocPageFragment='/'+templateDataMessage.text(),promise=ve.ui.MWTemplateTitleInputWidget.super.prototype.getLookupRequest.call(this);if(mw.config.get('wgVisualEditorConfig').cirrusSearchLookup){promise=promise.then(this.addExactMatch.bind(this)).promise({abort:function(){}});}if(!this.showTemplateDescriptions){return promise;}return promise.then(function(response){var redirects=(response.query&&response.query.redirects)||[],origPages=(response.query&&response.query.pages)||{},newPages=[];for(var pageId in origPages){if('index'in origPages[pageId]){newPages[origPages[pageId].index-1]=origPages[pageId];}else{for(var redirIndex in redirects){if(redirects[redirIndex].to===origPages[pageId].title){newPages[redirects[redirIndex].index-1]=origPages[pageId];break;}}}}if(templateDataInstalled){newPages=newPages.filter(function(page){return page.title.slice(0-templateDocPageFragment.length)!==
templateDocPageFragment;});}else{newPages=newPages.filter(function(page){return page;});}var titles=newPages.map(function(page){return page.title;});ve.setProp(response,'query','pages',newPages);originalResponse=response;if(titles.length>0){var xhr=widget.getApi().get({action:'templatedata',titles:titles,redirects:!!widget.showRedirects,includeMissingTitles:'1',lang:mw.config.get('wgUserLanguage')});return xhr.promise({abort:xhr.abort});}}).then(function(templateDataResponse){var pages=(templateDataResponse&&templateDataResponse.pages)||{};for(var index in pages){var page=pages[index];if(page.missing){var missingTitle={};missingTitle[page.title]={missing:!0};ve.init.platform.linkCache.setMissing(missingTitle);}else if(!page.notemplatedata){widget.descriptions[page.title]=page.description;}}return originalResponse;},function(){return originalResponse;}).promise({abort:function(){}});};ve.ui.MWTemplateTitleInputWidget.prototype.addExactMatch=function(response){var widget=this,query=
this.getQueryValue(),title=mw.Title.newFromText(query,this.namespace);if(!response.query||!title){return response;}var lowerTitle=title.getPrefixedText().toLowerCase(),metadata=response.query.redirects||[],foundMatchingMetadata=metadata.some(function(redirect){return redirect.from.toLowerCase()===lowerTitle;});if(foundMatchingMetadata){return response;}function containsPageId(pages,pageId){return pageId&&pages.some(function(page){return page.pageid===pageId;});}function unshiftPages(pages,newPage){pages.forEach(function(page){page.index++;});if(newPage&&newPage.title){newPage.index=1;pages.unshift(newPage);if(pages.length>widget.limit){pages.sort(function(a,b){return a.index-b.index;}).splice(widget.limit);}}}var i,matchingRedirects=response.query.pages.filter(function(page){return page.redirecttitle&&page.redirecttitle.toLowerCase()===lowerTitle;});if(matchingRedirects.length){for(i=matchingRedirects.length;i--;){var redirect=matchingRedirects[i];unshiftPages(response.query.pages,{
pageid:redirect.pageid,ns:redirect.ns,title:redirect.redirecttitle});}return response;}var matchingTitles=response.query.pages.filter(function(page){return page.title.toLowerCase()===lowerTitle;});if(matchingTitles.length){for(i=matchingTitles.length;i--;){unshiftPages(response.query.pages);matchingTitles[i].index=1;}return response;}return this.getApi().get({action:'query',generator:'prefixsearch',gpssearch:query,gpsnamespace:this.namespace,gpslimit:1}).then(function(prefixMatches){if(prefixMatches.query){for(var index in prefixMatches.query.pages){var prefixMatch=prefixMatches.query.pages[index];if(!containsPageId(response.query.pages,prefixMatch.pageid)){unshiftPages(response.query.pages,prefixMatch);}}}return response;},function(){return response;}).promise({abort:function(){}});};ve.ui.MWTemplateTitleInputWidget.prototype.getOptionWidgetData=function(title,data){return ve.extendObject(ve.ui.MWTemplateTitleInputWidget.super.prototype.getOptionWidgetData.apply(this,arguments),{
description:this.descriptions[title],redirecttitle:data.originalData.redirecttitle});};ve.ui.MWTemplateTitleInputWidget.prototype.createOptionWidget=function(data){var widget=ve.ui.MWTemplateTitleInputWidget.super.prototype.createOptionWidget.call(this,data);if(data.redirecttitle){var title=new mw.Title(data.redirecttitle),text=this.namespace!==null&&this.relative?title.getRelativeText(this.namespace):data.redirecttitle;var $desc=widget.$element.find('.mw-widget-titleOptionWidget-description');if(!$desc.length){$desc=$('<span>').addClass('mw-widget-titleOptionWidget-description').appendTo(widget.$element);}$desc.prepend($('<div>').addClass('ve-ui-mwTemplateTitleInputWidget-redirectedfrom').text(mw.msg('redirectedfrom',text)));}return widget;};ve.ui.MWAddParameterPage=function VeUiMWAddParameterPage(parameter,name,config){ve.ui.MWAddParameterPage.super.call(this,name,ve.extendObject({scrollable:!1},config));this.template=parameter.getTemplate();this.isExpanded=!1;this.
addParameterInputHeader=new OO.ui.ButtonWidget({label:ve.msg('visualeditor-dialog-transclusion-add-undocumented-param'),icon:'add',framed:!1,inline:!0,classes:['ve-ui-mwTransclusionDialog-addParameterFieldset-header']}).connect(this,{click:'togglePlaceholder'});this.paramInputField=new OO.ui.TextInputWidget({placeholder:ve.msg('visualeditor-dialog-transclusion-add-param-placeholder')}).connect(this,{change:'onParameterNameChanged',enter:'onParameterNameSubmitted'});this.saveButton=new OO.ui.ButtonWidget({label:ve.msg('visualeditor-dialog-transclusion-add-param-save'),flags:['primary','progressive'],disabled:!0}).connect(this,{click:'onParameterNameSubmitted'});this.addParameterInputField=new OO.ui.ActionFieldLayout(this.paramInputField,this.saveButton,{classes:['ve-ui-mwTransclusionDialog-addParameterFieldset-input']});var link=this.template.getTitle()||this.template.getTarget().wt;var $helpText=mw.message('visualeditor-dialog-transclusion-add-param-help',link).parseDom();ve.
init.platform.linkCache.styleElement(link,$helpText);this.addParameterFieldset=new OO.ui.FieldsetLayout({label:this.addParameterInputHeader.$element,helpInline:!0,help:$helpText,classes:['ve-ui-mwTransclusionDialog-addParameterFieldset'],$content:this.addParameterInputField.$element});ve.targetLinksToNewWindow(this.addParameterFieldset.$element[0]);this.togglePlaceholder(!1);this.$element.addClass('ve-ui-mwParameterPlaceholderPage').append(this.addParameterFieldset.$element);};OO.inheritClass(ve.ui.MWAddParameterPage,OO.ui.PageLayout);ve.ui.MWAddParameterPage.prototype.focus=function(){if(this.isExpanded){this.paramInputField.focus();return;}ve.ui.MWAddParameterPage.super.prototype.focus.apply(this,arguments);};ve.ui.MWAddParameterPage.prototype.onParameterNameChanged=function(value){var paramName=value.trim(),errors=this.getValidationErrors(paramName);this.addParameterInputField.setErrors(errors);this.saveButton.setDisabled(!paramName||errors.length);};ve.ui.MWAddParameterPage.
prototype.onParameterNameSubmitted=function(){var name=this.paramInputField.getValue().trim();if(!name||this.saveButton.isDisabled()){return;}this.paramInputField.setValue('');if(this.template.hasParameter(name)){return;}var param=new ve.dm.MWParameterModel(this.template,name);this.template.addParameter(param);this.emit('focusTemplateParameterById',param.getId());ve.track('activity.transclusion',{action:'add-unknown-parameter'});};ve.ui.MWAddParameterPage.prototype.getValidationErrors=function(name){if(!name){return[];}var forbiddenCharacter=name.match(/[={|}]/);if(forbiddenCharacter){return[mw.message('visualeditor-dialog-transclusion-add-param-error-forbidden-char',forbiddenCharacter[0]).parseDom()];}var key,spec=this.template.getSpec();if(spec.getParameterAliases(name).indexOf(name)!==-1){key='visualeditor-dialog-transclusion-add-param-error-alias';}else if(this.template.hasParameter(name)){key='visualeditor-dialog-transclusion-add-param-error-exists-selected';}else if(spec.
isParameterDeprecated(name)){key='visualeditor-dialog-transclusion-add-param-error-deprecated';}else if(spec.isKnownParameterOrAlias(name)){key='visualeditor-dialog-transclusion-add-param-error-exists-unselected';}if(!key){return[];}var label=spec.getParameterLabel(this.template.getOriginalParameterName(name)),$msg=mw.message(key,name,label).parseDom();ve.targetLinksToNewWindow($('<div>').append($msg)[0]);return[$msg];};ve.ui.MWAddParameterPage.prototype.togglePlaceholder=function(expand){this.isExpanded=expand===undefined?!this.isExpanded:!!expand;this.addParameterInputHeader.setIcon(this.isExpanded?'subtract':'add');this.addParameterFieldset.$element.toggleClass('ve-ui-mwTransclusionDialog-addParameterFieldset-collapsed',!this.isExpanded);if(this.isExpanded){this.paramInputField.focus();}};ve.ui.MWAddParameterPage.prototype.setOutlineItem=function(){ve.ui.MWAddParameterPage.super.prototype.setOutlineItem.apply(this,arguments);if(this.outlineItem){this.outlineItem.$element.empty().
removeAttr('class');}};ve.ui.MWTemplatePage=function VeUiMWTemplatePage(template,name,config){var link=template.getTitle(),veConfig=mw.config.get('wgVisualEditorConfig');config=ve.extendObject({scrollable:!1},config);ve.ui.MWTemplatePage.super.call(this,name,config);this.template=template;this.spec=template.getSpec();this.$description=$('<div>').addClass('ve-ui-mwTemplatePage-description');this.infoFieldset=new OO.ui.FieldsetLayout({label:this.spec.getLabel(),icon:'puzzle'});this.$description.text(this.spec.getDescription());var linkData=ve.init.platform.linkCache.getCached('_missing/'+link),pageMissing=link&&linkData&&linkData.missing;if(link){if(this.spec.getDescription()){this.$description.append($('<hr>'),$('<span>').addClass('ve-ui-mwTemplatePage-description-extra').append(!veConfig.transclusionDialogNewSidebar?mw.message('visualeditor-dialog-transclusion-more-template-description',this.spec.getLabel(),link).parseDom():mw.message('visualeditor-dialog-transclusion-see-template',
link).parseDom()));}else if(pageMissing){this.$description.addClass('ve-ui-mwTemplatePage-description-missing').append(mw.message('visualeditor-dialog-transclusion-absent-template',this.spec.getLabel()).parseDom());}else if(!veConfig.transclusionDialogNewSidebar||this.spec.isDocumented()){this.$description.addClass('ve-ui-mwTemplatePage-description-missing').append(mw.message('visualeditor-dialog-transclusion-no-template-description',this.spec.getLabel(),link).parseDom());}ve.targetLinksToNewWindow(this.$description[0]);}this.$description.find('a[href]').on('click',function(){ve.track('activity.transclusion',{action:'template-doc-link-click'});});this.infoFieldset.$element.append(this.$description);if(veConfig.transclusionDialogNewSidebar&&!pageMissing){var noticeWidget;if(!this.template.getSpec().getDocumentedParameterOrder().length){noticeWidget=new OO.ui.MessageWidget({label:mw.message('visualeditor-dialog-transclusion-no-parameters-description').parseDom(),classes:[
've-ui-mwTransclusionDialog-template-note']});}else if(!this.template.getSpec().isDocumented()){noticeWidget=new OO.ui.MessageWidget({label:mw.message('visualeditor-dialog-transclusion-no-template-data-description',link).parseDom(),classes:['ve-ui-mwTransclusionDialog-template-note'],type:'warning'});}if(noticeWidget&&noticeWidget.$element){ve.targetLinksToNewWindow(noticeWidget.$element[0]);this.infoFieldset.$element.append(noticeWidget.$element);}}this.$element.addClass('ve-ui-mwTemplatePage').append(this.infoFieldset.$element);if(!config.isReadOnly){if(!veConfig.transclusionDialogBackButton&&!veConfig.transclusionDialogNewSidebar){var removeButton=new OO.ui.ButtonWidget({framed:!1,icon:'trash',title:ve.msg('visualeditor-dialog-transclusion-remove-template'),flags:['destructive'],classes:['ve-ui-mwTransclusionDialog-removeButton']}).connect(this,{click:'onRemoveButtonClick'});removeButton.$element.appendTo(this.$element);}if(!veConfig.transclusionDialogNewSidebar){var addButton=
new OO.ui.ButtonWidget({framed:!1,icon:'parameter',label:ve.msg('visualeditor-dialog-transclusion-add-param')}).connect(this,{click:'addPlaceholderParameter'});$('<div>').addClass('ve-ui-mwTemplatePage-more').append(addButton.$element).appendTo(this.$element);}}};OO.inheritClass(ve.ui.MWTemplatePage,OO.ui.PageLayout);ve.ui.MWTemplatePage.prototype.setOutlineItem=function(){ve.ui.MWTemplatePage.super.prototype.setOutlineItem.apply(this,arguments);if(this.outlineItem){this.outlineItem.setIcon('puzzle').setMovable(!0).setRemovable(!0).setLabel(this.spec.getLabel());}};ve.ui.MWTemplatePage.prototype.onRemoveButtonClick=function(){this.template.remove();};ve.ui.MWTemplatePage.prototype.addPlaceholderParameter=function(){this.template.addParameter(new ve.dm.MWParameterModel(this.template));};ve.ui.MWParameterPage=function VeUiMWParameterPage(parameter,name,config){var paramName=parameter.getName(),veConfig=mw.config.get('wgVisualEditorConfig');config=ve.extendObject({scrollable:!1}
,config);ve.ui.MWParameterPage.super.call(this,name,config);this.edited=!1;this.parameter=parameter;this.originalValue=parameter.getValue();this.spec=parameter.getTemplate().getSpec();this.defaultValue=parameter.getDefaultValue();this.exampleValue=parameter.getExampleValue();this.$info=$('<div>');this.$actions=$('<div>');this.$labelElement=$('<div>');this.$field=$('<div>');this.useInlineDescriptions=veConfig.transclusionDialogInlineDescriptions;this.useSuggestedValues=veConfig.transclusionDialogSuggestedValues;this.useNewSidebar=veConfig.transclusionDialogNewSidebar;this.valueInput=this.createValueInput().setValue(this.parameter.getValue()).connect(this,{change:'onValueInputChange'});if(config.readOnly&&this.valueInput.setReadOnly){this.valueInput.setReadOnly(!0);}this.statusIndicator=new OO.ui.IndicatorWidget({classes:['ve-ui-mwParameterPage-statusIndicator']});var $doc=$('<div>').addClass('ve-ui-mwParameterPage-doc').append($('<p>').text(this.spec.getParameterDescription(
paramName)||''));if(this.parameter.isRequired()){this.statusIndicator.setIndicator('required').setTitle(ve.msg('visualeditor-dialog-transclusion-required-parameter'));$doc.append($('<p>').addClass('ve-ui-mwParameterPage-doc-required').text(ve.msg('visualeditor-dialog-transclusion-required-parameter-description')));}else if(this.parameter.isDeprecated()){this.statusIndicator.setIndicator('alert').setTitle(ve.msg('visualeditor-dialog-transclusion-deprecated-parameter'));$doc.append($('<p>').addClass('ve-ui-mwParameterPage-doc-deprecated').text(ve.msg('visualeditor-dialog-transclusion-deprecated-parameter-description',this.spec.getParameterDeprecationDescription(paramName))));}if(this.defaultValue){$doc.append($('<p>').addClass('ve-ui-mwParameterPage-doc-default').text(ve.msg('visualeditor-dialog-transclusion-param-default',this.defaultValue)));}if(this.exampleValue){$doc.append($('<p>').addClass('ve-ui-mwParameterPage-doc-example').text(ve.msg(this.useInlineDescriptions?
'visualeditor-dialog-transclusion-param-example-long':'visualeditor-dialog-transclusion-param-example',this.exampleValue)));}if(!this.rawValueInput&&!this.useNewSidebar){this.rawFallbackButton=new OO.ui.ButtonWidget({framed:!1,icon:'wikiText',title:ve.msg('visualeditor-dialog-transclusion-raw-fallback')}).connect(this,{click:'onRawFallbackButtonClick'});this.$actions.append(this.rawFallbackButton.$element);}if(!this.useInlineDescriptions){if($doc.text().trim()===''){this.infoButton=new OO.ui.ButtonWidget({disabled:!0,title:ve.msg('visualeditor-dialog-transclusion-param-info-missing'),framed:!1,icon:'info',classes:['ve-ui-mwParameterPage-infoButton']});}else{this.infoButton=new OO.ui.PopupButtonWidget({$overlay:config.$overlay,popup:{$content:$doc},title:ve.msg('visualeditor-dialog-transclusion-param-info'),framed:!1,icon:'info',classes:['ve-ui-mwParameterPage-infoButton']});}this.$actions.append(this.infoButton.$element);}if(!this.parameter.isRequired()&&!config.readOnly&&!
this.useNewSidebar){var removeButton=new OO.ui.ButtonWidget({framed:!1,icon:'trash',title:ve.msg('visualeditor-dialog-transclusion-remove-param'),flags:['destructive'],classes:['ve-ui-mwParameterPage-removeButton']}).connect(this,{click:'onRemoveButtonClick'});this.$actions.append(removeButton.$element);}this.$labelElement.on('click',this.onLabelClick.bind(this));this.$info.addClass('ve-ui-mwParameterPage-info').append(this.$labelElement,this.statusIndicator.$element);this.$actions.addClass('ve-ui-mwParameterPage-actions');this.$labelElement.addClass('ve-ui-mwParameterPage-label').text(this.spec.getParameterLabel(paramName));this.$field.addClass('ve-ui-mwParameterPage-field').append(this.valueInput.$element);if(this.useNewSidebar&&!this.parameter.isDocumented()){var undocumentedLabel=new OO.ui.LabelWidget({label:ve.msg('visualeditor-dialog-transclusion-param-undocumented'),classes:['ve-ui-mwParameterPage-undocumentedLabel']});this.$labelElement.after(undocumentedLabel.$element);}if(
this.useSuggestedValues&&this.parameter.getSuggestedValues().length){this.warningMessage=new OO.ui.MessageWidget({inline:!0,classes:['ve-ui-mwParameterPage-warning']}).toggle(!1);this.$field.append(this.warningMessage.$element);}this.$element.addClass('ve-ui-mwParameterPage').append(this.$info,this.$field,this.$actions);if(this.useInlineDescriptions){this.$field.addClass('ve-ui-mwParameterPage-inlineDescription');this.collapsibleDoc=new ve.ui.MWExpandableContentElement({classes:['ve-ui-mwParameterPage-inlineDescription'],$content:$doc});this.$info.after(this.collapsibleDoc.$element);}if(!config.readOnly&&!this.useNewSidebar){var addButton=new OO.ui.ButtonWidget({framed:!1,icon:'parameter',label:this.useNewSidebar?ve.msg('visualeditor-dialog-transclusion-add-undocumented-param'):ve.msg('visualeditor-dialog-transclusion-add-param')}).connect(this,{click:'addPlaceholderParameter'});$('<div>').addClass('ve-ui-mwParameterPage-addUndocumented').append(addButton.$element).appendTo(
this.$element);}};OO.inheritClass(ve.ui.MWParameterPage,OO.ui.PageLayout);ve.ui.MWParameterPage.prototype.getDefaultInputConfig=function(){var required=this.parameter.isRequired(),valueInputConfig={autosize:!0,required:required,validate:required?'non-empty':null};if(this.defaultValue){valueInputConfig.placeholder=ve.msg('visualeditor-dialog-transclusion-param-default',this.defaultValue);}else if(this.exampleValue&&!this.useInlineDescriptions){valueInputConfig.placeholder=ve.msg(this.useInlineDescriptions?'visualeditor-dialog-transclusion-param-example-long':'visualeditor-dialog-transclusion-param-example',this.exampleValue);}return valueInputConfig;};ve.ui.MWParameterPage.prototype.createValueInput=function(){var type=this.parameter.getType(),value=this.parameter.getValue(),valueInputConfig=this.getDefaultInputConfig();this.rawValueInput=!1;delete valueInputConfig.validate;if(type==='wiki-page-name'&&(value===''||mw.Title.newFromText(value))){return new mw.widgets.TitleInputWidget
($.extend({api:ve.init.target.getContentApi()},valueInputConfig));}else if(type==='wiki-file-name'&&(value===''||mw.Title.newFromText(value))){return new mw.widgets.TitleInputWidget($.extend({},valueInputConfig,{api:ve.init.target.getContentApi(),namespace:6,showImages:!0}));}else if(type==='wiki-user-name'&&(value===''||mw.Title.newFromText(value))){valueInputConfig.validate=function(val){return!!mw.Title.newFromText(val);};return new mw.widgets.UserInputWidget($.extend({api:ve.init.target.getContentApi()},valueInputConfig));}else if(type==='wiki-template-name'&&(value===''||mw.Title.newFromText(value))){return new mw.widgets.TitleInputWidget($.extend({api:ve.init.target.getContentApi()},valueInputConfig,{namespace:mw.config.get('wgNamespaceIds').template}));}else if(type==='boolean'&&(value==='1'||value==='0')){return new ve.ui.MWParameterCheckboxInputWidget(valueInputConfig);}else if(type==='url'&&(value===''||ve.init.platform.getExternalLinkUrlProtocolsRegExp().exec(value.trim())
)){return ve.ui.MWExternalLinkAnnotationWidget.static.createExternalLinkInputWidget(valueInputConfig);}else if(this.useSuggestedValues&&this.parameter.getSuggestedValues().length&&this.isSuggestedValueType(type)){valueInputConfig.menu={filterFromInput:!0,highlightOnFilter:!0};valueInputConfig.options=this.parameter.getSuggestedValues().map(function(suggestedValue){return{data:suggestedValue};});this.rawValueInput=!0;return new OO.ui.ComboBoxInputWidget(valueInputConfig);}else if(type!=='line'||value.indexOf('\n')!==-1){this.rawValueInput=!0;return new ve.ui.MWLazyMultilineTextInputWidget(valueInputConfig);}return new OO.ui.TextInputWidget(valueInputConfig);};ve.ui.MWParameterPage.prototype.isSuggestedValueType=function(type){return['unknown','content','line','string','number','unbalanced-wikitext'].indexOf(type)>-1;};ve.ui.MWParameterPage.prototype.containsSomeValue=function(){return!!(this.valueInput.getValue()||this.defaultValue);};ve.ui.MWParameterPage.prototype.
onValueInputChange=function(){var value=this.valueInput.getValue();if(!this.edited){ve.track('activity.transclusion',{action:'edit-parameter-value'});}this.edited=!0;this.parameter.setValue(value);if(this.outlineItem){this.outlineItem.setFlags({empty:!this.containsSomeValue()});}if(this.warningMessage){var isNotSuggestedValue=value&&this.parameter.getSuggestedValues().length>0&&this.parameter.getSuggestedValues().indexOf(value)===-1;if(isNotSuggestedValue){this.warningMessage.setLabel(ve.msg('visualeditor-dialog-transclusion-suggestedvalues-warning'));}this.warningMessage.toggle(isNotSuggestedValue);}};ve.ui.MWParameterPage.prototype.onRemoveButtonClick=function(){this.parameter.remove();};ve.ui.MWParameterPage.prototype.onRawFallbackButtonClick=function(){this.valueInput.$element.detach();if(this.rawValueInput){this.valueInput=this.createValueInput().setValue(this.valueInput.getValue());}else{this.valueInput=new OO.ui.TextInputWidget(this.getDefaultInputConfig()).setValue(this.
edited?this.valueInput.getValue():this.originalValue);this.valueInput.$input.addClass('ve-ui-mwParameter-wikitextFallbackInput');this.rawValueInput=!0;}this.valueInput.connect(this,{change:'onValueInputChange'});this.$field.append(this.valueInput.$element);};ve.ui.MWParameterPage.prototype.addPlaceholderParameter=function(){var template=this.parameter.getTemplate();template.addParameter(new ve.dm.MWParameterModel(template));};ve.ui.MWParameterPage.prototype.onLabelClick=function(){this.valueInput.simulateLabelClick();};ve.ui.MWParameterPage.prototype.setOutlineItem=function(){ve.ui.MWParameterPage.super.prototype.setOutlineItem.apply(this,arguments);if(this.outlineItem){this.outlineItem.setIcon('parameter').setMovable(!1).setRemovable(!0).setLevel(1).setFlags({empty:!this.containsSomeValue()}).setLabel(this.spec.getParameterLabel(this.parameter.getName()));if(this.parameter.isRequired()){this.outlineItem.setIndicator('required').setTitle(ve.msg(
'visualeditor-dialog-transclusion-required-parameter'));}if(this.parameter.isDeprecated()){this.outlineItem.setIndicator('alert').setTitle(ve.msg('visualeditor-dialog-transclusion-deprecated-parameter'));}}};ve.ui.MWParameterPage.prototype.focus=function(){this.valueInput.focus();};ve.ui.MWParameterPage.prototype.updateSize=function(){if(this.collapsibleDoc){this.collapsibleDoc.updateSize();}};ve.ui.MWParameterPlaceholderPage=function VeUiMWParameterPlaceholderPage(parameter,name,config){var veConfig=mw.config.get('wgVisualEditorConfig');config=ve.extendObject({scrollable:!1},config);ve.ui.MWParameterPlaceholderPage.super.call(this,name,config);this.name=name;this.parameter=parameter;this.template=this.parameter.getTemplate();this.addParameterSearch=new ve.ui.MWParameterSearchWidget(this.template,{showAll:!!config.expandedParamList}).connect(this,{choose:'onParameterChoose',showAll:'onParameterShowAll'});this.addParameterFieldset=new OO.ui.FieldsetLayout({label:ve.msg(
'visualeditor-dialog-transclusion-add-param'),icon:'parameter',classes:['ve-ui-mwTransclusionDialog-addParameterFieldset'],$content:this.addParameterSearch.$element});this.addParameterFieldset.$element.attr('aria-label',ve.msg('visualeditor-dialog-transclusion-add-param'));this.$element.addClass('ve-ui-mwParameterPlaceholderPage').append(this.addParameterFieldset.$element);if(!veConfig.transclusionDialogNewSidebar){var removeButton=new OO.ui.ButtonWidget({framed:!1,icon:'trash',title:ve.msg('visualeditor-dialog-transclusion-remove-param'),flags:['destructive'],classes:['ve-ui-mwTransclusionDialog-removeButton']}).connect(this,{click:'onRemoveButtonClick'});this.$element.append(removeButton.$element);}};OO.inheritClass(ve.ui.MWParameterPlaceholderPage,OO.ui.PageLayout);ve.ui.MWParameterPlaceholderPage.prototype.onParameterShowAll=function(){this.emit('showAll',this.name);};ve.ui.MWParameterPlaceholderPage.prototype.setOutlineItem=function(){ve.ui.MWParameterPlaceholderPage.super.
prototype.setOutlineItem.apply(this,arguments);if(this.outlineItem){this.outlineItem.setIcon('parameter').setMovable(!1).setRemovable(!0).setLevel(1).setFlags(['placeholder']).setLabel(ve.msg('visualeditor-dialog-transclusion-add-param'));}};ve.ui.MWParameterPlaceholderPage.prototype.onParameterChoose=function(name){this.addParameterSearch.query.setValue('');if(!name||this.template.hasParameter(name)){return;}var knownBefore=this.template.getSpec().isKnownParameterOrAlias(name);var param=new ve.dm.MWParameterModel(this.template,name);this.template.addParameter(param);this.emit('focusTemplateParameterById',param.getId());ve.track('activity.transclusion',{action:knownBefore?'add-known-parameter':'add-unknown-parameter'});};ve.ui.MWParameterPlaceholderPage.prototype.onRemoveButtonClick=function(){this.parameter.remove();};ve.ui.MWTemplatePlaceholderPage=function VeUiMWTemplatePlaceholderPage(placeholder,name,config){var veConfig=mw.config.get('wgVisualEditorConfig');config=ve.
extendObject({scrollable:!1},config);ve.ui.MWTemplatePlaceholderPage.super.call(this,name,config);this.placeholder=placeholder;this.addTemplateInput=new ve.ui.MWTemplateTitleInputWidget({$overlay:config.$overlay,showDescriptions:!0,api:ve.init.target.getContentApi()}).connect(this,{change:'onTemplateInputChange',enter:'onAddTemplate'});this.addTemplateInput.getLookupMenu().connect(this,{choose:'onAddTemplate'});this.addTemplateInput.$input.attr('aria-label',ve.msg('visualeditor-dialog-transclusion-add-template'));this.addTemplateButton=new OO.ui.ButtonWidget({label:ve.msg('visualeditor-dialog-transclusion-add-template'),flags:['progressive'],classes:['ve-ui-mwTransclusionDialog-addButton'],disabled:!0}).connect(this,{click:'onAddTemplate'});var addTemplateActionFieldLayout=new OO.ui.ActionFieldLayout(this.addTemplateInput,this.addTemplateButton,{align:'top'});var addTemplateFieldsetConfig={label:ve.msg('visualeditor-dialog-transclusion-placeholder'),icon:'puzzle',classes:[
've-ui-mwTransclusionDialog-addTemplateFieldset'],items:[addTemplateActionFieldLayout]};if(mw.config.get('wgVisualEditorConfig').templateSearchImprovements){var dialogTitle=this.placeholder.getTransclusion().parts.length===1?'visualeditor-dialog-transclusion-template-search':'visualeditor-dialog-transclusion-add-template';var feedbackMessage=new ve.ui.MWDismissibleMessageWidget({messageKey:'visualeditor-dialog-transclusion-feedback-message'}).connect(this,{close:'focus'});addTemplateFieldsetConfig=ve.extendObject(addTemplateFieldsetConfig,{label:ve.msg(dialogTitle),help:ve.msg('visualeditor-dialog-transclusion-template-search-help'),helpInline:!0,items:[].concat([feedbackMessage],addTemplateFieldsetConfig.items)});}this.addTemplateFieldset=new OO.ui.FieldsetLayout(addTemplateFieldsetConfig);this.$element.addClass('ve-ui-mwTemplatePlaceholderPage').append(this.addTemplateFieldset.$element);if(!veConfig.transclusionDialogNewSidebar){this.removeButton=new OO.ui.ButtonWidget({framed:
!1,icon:'trash',title:ve.msg('visualeditor-dialog-transclusion-remove-template'),flags:['destructive'],classes:['ve-ui-mwTransclusionDialog-removeButton']}).connect(this,{click:'onRemoveButtonClick'});if(this.placeholder.getTransclusion().parts.length===1){this.removeButton.toggle(!1);}this.$element.append(this.removeButton.$element);}};OO.inheritClass(ve.ui.MWTemplatePlaceholderPage,OO.ui.PageLayout);ve.ui.MWTemplatePlaceholderPage.prototype.setOutlineItem=function(){ve.ui.MWTemplatePlaceholderPage.super.prototype.setOutlineItem.apply(this,arguments);var dialogTitle=(this.placeholder.getTransclusion().parts.length===1&&mw.config.get('wgVisualEditorConfig').templateSearchImprovements)?'visualeditor-dialog-transclusion-template-search':'visualeditor-dialog-transclusion-add-template';if(this.outlineItem){this.outlineItem.setIcon('puzzle').setMovable(!0).setRemovable(!0).setFlags(['placeholder']).setLabel(ve.msg(dialogTitle));}};ve.ui.MWTemplatePlaceholderPage.prototype.focus=
function(){this.addTemplateInput.focus();this.addTemplateInput.lookupMenu.width=this.addTemplateInput.$input[0].clientWidth;};ve.ui.MWTemplatePlaceholderPage.prototype.onAddTemplate=function(){var transclusion=this.placeholder.getTransclusion(),menu=this.addTemplateInput.getLookupMenu();if(menu.isVisible()){menu.chooseItem(menu.findSelectedItem());}var name=this.addTemplateInput.getMWTitle();if(!name){return;}var event={action:'add-template',template_names:[name.getPrefixedText()]};var editCountBucket=mw.config.get('wgUserEditCountBucket');if(editCountBucket!==null){event.user_edit_count_bucket=editCountBucket;}mw.track('event.VisualEditorTemplateDialogUse',event);var part=ve.dm.MWTemplateModel.newFromName(transclusion,name);transclusion.replacePart(this.placeholder,part);this.addTemplateInput.pushPending();this.addTemplateInput.closeLookupMenu();this.addTemplateButton.setDisabled(!0);if(this.removeButton){this.removeButton.setDisabled(!0);}};ve.ui.MWTemplatePlaceholderPage.
prototype.onTemplateInputChange=function(){this.addTemplateButton.setDisabled(this.addTemplateInput.getMWTitle()===null);};ve.ui.MWTemplatePlaceholderPage.prototype.onRemoveButtonClick=function(){this.placeholder.remove();};ve.ui.MWTransclusionContentPage=function VeUiMWTransclusionContentPage(content,name,config){var veConfig=mw.config.get('wgVisualEditorConfig');config=ve.extendObject({scrollable:!1},config);ve.ui.MWTransclusionContentPage.super.call(this,name,config);this.content=content;this.textInput=new ve.ui.MWLazyMultilineTextInputWidget({autosize:!0,classes:['ve-ui-mwTransclusionDialog-input']}).setValue(this.content.serialize()).setReadOnly(config.isReadOnly).connect(this,{change:'onTextInputChange'});this.valueFieldset=new OO.ui.FieldsetLayout({label:ve.msg(veConfig.transclusionDialogNewSidebar?'visualeditor-dialog-transclusion-wikitext':'visualeditor-dialog-transclusion-content'),icon:'wikiText',$content:this.textInput.$element});this.$element.addClass(
've-ui-mwTransclusionContentPage').append(this.valueFieldset.$element);if(!config.isReadOnly&&!veConfig.transclusionDialogNewSidebar){var removeButton=new OO.ui.ButtonWidget({framed:!1,icon:'trash',title:ve.msg('visualeditor-dialog-transclusion-remove-content'),flags:['destructive'],classes:['ve-ui-mwTransclusionDialog-removeButton']}).connect(this,{click:'onRemoveButtonClick'});removeButton.$element.appendTo(this.$element);}};OO.inheritClass(ve.ui.MWTransclusionContentPage,OO.ui.PageLayout);ve.ui.MWTransclusionContentPage.prototype.setOutlineItem=function(){ve.ui.MWTransclusionContentPage.super.prototype.setOutlineItem.apply(this,arguments);if(this.outlineItem){this.outlineItem.setIcon('wikiText').setMovable(!0).setRemovable(!0).setLabel(ve.msg('visualeditor-dialog-transclusion-content'));}};ve.ui.MWTransclusionContentPage.prototype.onTextInputChange=function(){this.content.setWikitext(this.textInput.getValue());};ve.ui.MWTransclusionContentPage.prototype.onRemoveButtonClick=
function(){this.content.remove();};ve.ui.MWRequiredParamBlankConfirmDialog=function VeUiMWRequiredParamBlankConfirmDialog(config){ve.ui.MWRequiredParamBlankConfirmDialog.super.call(this,config);};OO.inheritClass(ve.ui.MWRequiredParamBlankConfirmDialog,OO.ui.MessageDialog);ve.ui.MWRequiredParamBlankConfirmDialog.static.name='requiredparamblankconfirm';ve.ui.MWRequiredParamBlankConfirmDialog.static.size='medium';ve.ui.MWRequiredParamBlankConfirmDialog.static.actions=[{action:'ok',label:OO.ui.deferMsg('visualeditor-dialog-transclusion-required-parameter-dialog-ok'),flags:['primary','progressive']},{action:'cancel',label:OO.ui.deferMsg('visualeditor-dialog-transclusion-required-parameter-dialog-cancel'),flags:['safe','back']}];ve.ui.windowFactory.register(ve.ui.MWRequiredParamBlankConfirmDialog);ve.ui.MWTemplateDialog=function VeUiMWTemplateDialog(config){ve.ui.MWTemplateDialog.super.call(this,config);this.transclusionModel=null;this.loaded=!1;this.altered=!1;this.preventReselection=
!1;this.expandedParamList={};this.useNewSidebar=mw.config.get('wgVisualEditorConfig').transclusionDialogNewSidebar;this.confirmOverlay=new ve.ui.Overlay({classes:['ve-ui-overlay-global']});this.confirmDialogs=new ve.ui.WindowManager({factory:ve.ui.windowFactory,isolate:!0});this.confirmOverlay.$element.append(this.confirmDialogs.$element);$(document.body).append(this.confirmOverlay.$element);};OO.inheritClass(ve.ui.MWTemplateDialog,ve.ui.NodeDialog);ve.ui.MWTemplateDialog.static.modelClasses=[ve.dm.MWTransclusionNode];ve.ui.MWTemplateDialog.static.bookletLayoutConfig={continuous:!0,outlined:!1};ve.ui.MWTemplateDialog.prototype.getReadyProcess=function(data){return ve.ui.MWTemplateDialog.super.prototype.getReadyProcess.call(this,data).next(function(){this.bookletLayout.focus(1);this.bookletLayout.stackLayout.getItems().forEach(function(page){if(page instanceof ve.ui.MWParameterPage){page.updateSize();}});},this);};ve.ui.MWTemplateDialog.prototype.onTransclusionModelChange=
function(){if(this.loaded){this.altered=!0;this.setApplicableStatus();}};ve.ui.MWTemplateDialog.prototype.onReplacePart=function(removed,added){var reselect,removePages=[];if(removed){var partPage=this.bookletLayout.getPage(removed.getId());if(removed instanceof ve.dm.MWTemplateModel){var params=removed.getParameters();for(var name in params){removePages.push(this.bookletLayout.getPage(params[name].getId()));delete this.expandedParamList[params[name].getId()];}removed.disconnect(this);}if(this.loaded&&!this.preventReselection&&partPage.isActive()){var closestPage=this.bookletLayout.findClosestPage(partPage);reselect=closestPage&&closestPage.getName();}removePages.push(partPage);this.bookletLayout.removePages(removePages);}if(added){var page=this.getPageFromPart(added);if(page){this.bookletLayout.addPages([page],this.transclusionModel.getIndex(added));if(reselect){reselect=added.getId();}if(added instanceof ve.dm.MWTemplateModel){this.preventReselection=!0;var names=added.
getOrderedParameterNames();for(var i=0;i<names.length;i++){this.onAddParameter(added.getParameter(names[i]));}added.connect(this,{add:'onAddParameter',remove:'onRemoveParameter'});var shouldAddPlaceholder=this.loaded&&added.addPromptedParameters()===0;this.preventReselection=!1;if(names.length){reselect=added.getParameter(names[0]).getId();}else if(shouldAddPlaceholder&&!this.useNewSidebar){page.addPlaceholderParameter();}if(this.useNewSidebar){var documentedParameters=added.getSpec().getDocumentedParameterOrder(),undocumentedParameters=added.getSpec().getUndocumentedParameterNames();if(!documentedParameters.length||undocumentedParameters.length){page.addPlaceholderParameter();}}}}}if(reselect){this.focusPart(reselect);}if(this.loaded&&(added||removed)){this.altered=!0;}this.setApplicableStatus();this.updateTitle();};ve.ui.MWTemplateDialog.prototype.onParameterPlaceholderShowAll=function(pageId){this.expandedParamList[pageId]=!0;};ve.ui.MWTemplateDialog.prototype.onAddParameter=
function(param){var page;if(param.getName()){page=new ve.ui.MWParameterPage(param,param.getId(),{$overlay:this.$overlay,readOnly:this.isReadOnly()});}else if(this.useNewSidebar){page=new ve.ui.MWAddParameterPage(param,param.getId(),{$overlay:this.$overlay}).connect(this,{focusTemplateParameterById:'focusPart'});}else{page=new ve.ui.MWParameterPlaceholderPage(param,param.getId(),{$overlay:this.$overlay,expandedParamList:!!this.expandedParamList[param.getId()]}).connect(this,{showAll:'onParameterPlaceholderShowAll',focusTemplateParameterById:'focusPart'});}this.bookletLayout.addPages([page],this.transclusionModel.getIndex(param));if(this.loaded){if(!this.preventReselection&&!param.getName()){this.focusPart(param.getId());}this.altered=!0;this.setApplicableStatus();if(page instanceof ve.ui.MWParameterPage){page.updateSize();}}};ve.ui.MWTemplateDialog.prototype.onRemoveParameter=function(param){var page=this.bookletLayout.getPage(param.getId()),reselect=this.bookletLayout.findClosestPage
(page);if(this.loaded&&!this.preventReselection&&!this.pocSidebar){this.focusPart(reselect.getName());}this.bookletLayout.removePages([page]);if(this.loaded){this.altered=!0;this.setApplicableStatus();}};ve.ui.MWTemplateDialog.prototype.setApplicableStatus=function(){var parts=this.transclusionModel&&this.transclusionModel.getParts(),startsWithPlaceholder=parts&&parts[0]instanceof ve.dm.MWTemplatePlaceholderModel,canSave=!startsWithPlaceholder;this.actions.setAbilities({done:canSave&&this.altered});};ve.ui.MWTemplateDialog.prototype.getBodyHeight=function(){return 400;};ve.ui.MWTemplateDialog.prototype.getPageFromPart=function(part){if(part instanceof ve.dm.MWTemplateModel){return new ve.ui.MWTemplatePage(part,part.getId(),{$overlay:this.$overlay,isReadOnly:this.isReadOnly()});}else if(part instanceof ve.dm.MWTemplatePlaceholderModel){return new ve.ui.MWTemplatePlaceholderPage(part,part.getId(),{$overlay:this.$overlay});}return null;};ve.ui.MWTemplateDialog.prototype.getSelectedNode=
function(data){var selectedNode=ve.ui.MWTemplateDialog.super.prototype.getSelectedNode.call(this);data=data||{};if(selectedNode&&data.template&&!selectedNode.isSingleTemplate(data.template)){return null;}return selectedNode;};ve.ui.MWTemplateDialog.prototype.updateTitle=function(){var parts=this.transclusionModel&&this.transclusionModel.getParts(),title=ve.msg('visualeditor-dialog-transclusion-loading');if(parts&&parts.length===1){if(parts[0]instanceof ve.dm.MWTemplateModel){title=ve.msg(this.getMode()==='insert'?'visualeditor-dialog-transclusion-title-insert-known-template':'visualeditor-dialog-transclusion-title-edit-known-template',parts[0].getSpec().getLabel());}else{title=ve.msg('visualeditor-dialog-transclusion-title-insert-template');}}this.title.setLabel(title);};ve.ui.MWTemplateDialog.prototype.initialize=function(){ve.ui.MWTemplateDialog.super.prototype.initialize.call(this);this.bookletLayout=new OO.ui.BookletLayout(this.constructor.static.bookletLayoutConfig);this.$content.
addClass('ve-ui-mwTemplateDialog');};ve.ui.MWTemplateDialog.prototype.checkRequiredParameters=function(){var blankRequired=[],deferred=ve.createDeferred();this.bookletLayout.stackLayout.getItems().forEach(function(page){if(!(page instanceof ve.ui.MWParameterPage)){return;}if(page.parameter.isRequired()&&!page.valueInput.getValue()){blankRequired.push(mw.msg('quotation-marks',page.parameter.template.getSpec().getParameterLabel(page.parameter.getName())));}});if(blankRequired.length){this.confirmDialogs.openWindow('requiredparamblankconfirm',{message:mw.msg('visualeditor-dialog-transclusion-required-parameter-is-blank',mw.language.listToText(blankRequired),blankRequired.length),title:mw.msg('visualeditor-dialog-transclusion-required-parameter-dialog-title',blankRequired.length)}).closed.then(function(data){if(data.action==='ok'){deferred.resolve();}else{deferred.reject();}});}else{deferred.resolve();}return deferred.promise();};ve.ui.MWTemplateDialog.prototype.getActionProcess=function(
action){var dialog=this;if(action==='done'){return new OO.ui.Process(function(){var deferred=ve.createDeferred();dialog.checkRequiredParameters().done(function(){var surfaceModel=dialog.getFragment().getSurface(),obj=dialog.transclusionModel.getPlainObject(),modelPromise=ve.createDeferred().resolve().promise();dialog.pushPending();if(dialog.selectedNode instanceof ve.dm.MWTransclusionNode){dialog.transclusionModel.updateTransclusionNode(surfaceModel,dialog.selectedNode);}else if(obj!==null){dialog.fragment=dialog.getFragment().collapseToEnd();modelPromise=dialog.transclusionModel.insertTransclusionNode(dialog.getFragment());}var templateEvent={action:'save',template_names:[]};var editCountBucket=mw.config.get('wgUserEditCountBucket');if(editCountBucket!==null){templateEvent.user_edit_count_bucket=editCountBucket;}for(var i=0;i<dialog.transclusionModel.getParts().length;i++){if(dialog.transclusionModel.getParts()[i].getTitle){templateEvent.template_names.push(dialog.transclusionModel.
getParts()[i].getTitle());}}mw.track('event.VisualEditorTemplateDialogUse',templateEvent);return modelPromise.then(function(){dialog.close({action:action}).closed.always(dialog.popPending.bind(dialog));});}).always(deferred.resolve);return deferred;});}return ve.ui.MWTemplateDialog.super.prototype.getActionProcess.call(this,action);};ve.ui.MWTemplateDialog.prototype.getSetupProcess=function(data){data=data||{};return ve.ui.MWTemplateDialog.super.prototype.getSetupProcess.call(this,data).next(function(){var promise,dialog=this;this.loaded=!1;this.altered=!1;this.transclusionModel=new ve.dm.MWTransclusionModel(this.getFragment().getDocument());this.transclusionModel.connect(this,{replace:'onReplacePart',change:'onTransclusionModelChange'});this.bookletLayout.$element.detach();this.bookletLayout.autoFocus=!1;if(this.useNewSidebar){if(!this.pocSidebar){this.pocSidebar=new ve.ui.MWTransclusionOutlineContainerWidget();this.pocSidebar.connect(this,{focusPageByName:'focusPart',
filterPagesByName:'onFilterPagesByName',updateOutlineControlButtons:'onUpdateOutlineControlButtons'});this.bookletLayout.connect(this,{set:'onBookletLayoutSetPage'});this.bookletLayout.stackLayout.$element.on('focusin',this.onBookletLayoutPageFocused.bind(this));}else{this.pocSidebar.clear();}this.transclusionModel.connect(this.pocSidebar,{replace:'onReplacePart',change:['onTransclusionModelChange',this.transclusionModel]});}if(!this.selectedNode){if(data.template){var template=ve.dm.MWTemplateModel.newFromName(this.transclusionModel,data.template);promise=this.transclusionModel.addPart(template).then(this.initializeNewTemplateParameters.bind(this));}else{promise=this.transclusionModel.addPart(new ve.dm.MWTemplatePlaceholderModel(this.transclusionModel));}}else{var templateEvent={action:'edit',template_names:[]};var editCountBucket=mw.config.get('wgUserEditCountBucket');if(editCountBucket!==null){templateEvent.user_edit_count_bucket=editCountBucket;}for(var i=0;i<this.selectedNode.
partsList.length;i++){if(this.selectedNode.partsList[i].templatePage){templateEvent.template_names.push(this.selectedNode.partsList[i].templatePage);}}mw.track('event.VisualEditorTemplateDialogUse',templateEvent);promise=this.transclusionModel.load(ve.copy(this.selectedNode.getAttribute('mw'))).then(this.initializeTemplateParameters.bind(this));}this.actions.setAbilities({done:!1});return promise.then(function(){dialog.transclusionModel.addPromptedParameters();dialog.loaded=!0;dialog.$element.addClass('ve-ui-mwTemplateDialog-ready');dialog.$body.append(dialog.bookletLayout.$element);if(dialog.pocSidebar){var $debugContainer=dialog.bookletLayout.outlinePanel.$element.children('.ve-ui-mwTemplateDialog-pocSidebar-debug-container');if(!$debugContainer.length){$debugContainer=$('<div>').addClass('ve-ui-mwTemplateDialog-pocSidebar-debug-container').prependTo(dialog.bookletLayout.outlinePanel.$element);}$debugContainer.append(dialog.pocSidebar.$element,dialog.bookletLayout.
outlineSelectWidget.$element);dialog.bookletLayout.outlineSelectWidget.toggle(!1);}dialog.bookletLayout.autoFocus=!0;});},this);};ve.ui.MWTemplateDialog.prototype.initializeNewTemplateParameters=function(){var parts=this.transclusionModel.getParts();for(var i=0;i<parts.length;i++){if(parts[i]instanceof ve.dm.MWTemplateModel){parts[i].addPromptedParameters();}}};ve.ui.MWTemplateDialog.prototype.initializeTemplateParameters=function(){};ve.ui.MWTemplateDialog.prototype.onFilterPagesByName=function(visibility){for(var pageName in visibility){var page=this.bookletLayout.getPage(pageName);if(page){page.toggle(visibility[pageName]);}}};ve.ui.MWTemplateDialog.prototype.onUpdateOutlineControlButtons=function(pageName){this.bookletLayout.getOutline().items.forEach(function(item){item.setSelected(item.getData()===pageName);});this.bookletLayout.getOutlineControls().onOutlineChange();};ve.ui.MWTemplateDialog.prototype.focusPart=function(pageName){if(this.pocSidebar&&pageName.indexOf('/')===-
1){setTimeout(this.pocSidebar.selectPartById.bind(this.pocSidebar,pageName));this.bookletLayout.focus();this.bookletLayout.setPage(pageName);}else if(this.bookletLayout.isOutlined()){this.bookletLayout.getOutline().selectItemByData(pageName);}else{this.bookletLayout.setPage(pageName);}};ve.ui.MWTemplateDialog.prototype.onBookletLayoutSetPage=function(page){var partId=page.getName().split('/',1)[0];this.pocSidebar.selectPartById(partId);};ve.ui.MWTemplateDialog.prototype.onBookletLayoutPageFocused=function(e){var $focusedPage=$(e.target).closest('.oo-ui-pageLayout');for(var pageName in this.bookletLayout.pages){if(this.bookletLayout.getPage(pageName).$element[0]===$focusedPage[0]){this.pocSidebar.highlightSubItemByPageName(pageName);break;}}};ve.ui.MWTemplateDialog.prototype.getTeardownProcess=function(data){return ve.ui.MWTemplateDialog.super.prototype.getTeardownProcess.call(this,data).first(function(){this.$element.removeClass('ve-ui-mwTemplateDialog-ready');this.transclusionModel.
disconnect(this);this.transclusionModel.abortAllApiRequests();this.transclusionModel=null;this.bookletLayout.clearPages();this.content=null;},this);};ve.ui.MWTransclusionDialog=function VeUiMWTransclusionDialog(config){var veConfig=mw.config.get('wgVisualEditorConfig');ve.ui.MWTransclusionDialog.super.call(this,config);this.isSidebarExpanded=null;this.resetConfirmation=new OO.ui.FieldsetLayout({classes:['oo-ui-processDialog-errors']});this.resetConfirmationTitle=new OO.ui.LabelWidget({label:OO.ui.deferMsg('visualeditor-dialog-transclusion-reset-confirmation-title')});this.resetConfirmationMessage=new OO.ui.MessageWidget({label:OO.ui.deferMsg('visualeditor-dialog-transclusion-reset-confirmation-message'),type:'error'});this.resetConfirmationCancelButton=new OO.ui.ButtonWidget({label:OO.ui.deferMsg('visualeditor-dialog-transclusion-reset-confirmation-cancel')});this.resetConfirmationResetButton=new OO.ui.ButtonWidget({label:OO.ui.deferMsg(
'visualeditor-dialog-transclusion-reset-confirmation-reset'),flags:['primary','destructive']});this.resetConfirmationCancelButton.connect(this,{click:'resetConfirmationHide'});this.resetConfirmationResetButton.connect(this,{click:'resetConfirmationReset'});this.resetConfirmation.addItems([new OO.ui.HorizontalLayout({items:[this.resetConfirmationTitle],classes:['oo-ui-processDialog-errors-title']}),this.resetConfirmationMessage,new OO.ui.HorizontalLayout({items:[this.resetConfirmationCancelButton,this.resetConfirmationResetButton],classes:['oo-ui-processDialog-errors-actions']})]);this.resetConfirmation.toggle(!1);this.$content.append(this.resetConfirmation.$element);this.useInlineDescriptions=veConfig.transclusionDialogInlineDescriptions;this.useBackButton=veConfig.transclusionDialogBackButton;this.useSearchImprovements=veConfig.templateSearchImprovements;this.useNewSidebar=veConfig.transclusionDialogNewSidebar;if(this.useInlineDescriptions){this.$element.addClass(
've-ui-mwTransclusionDialog-bigger');}if(this.useSearchImprovements){this.$element.addClass('ve-ui-mwTransclusionDialog-enhancedSearch');}if(this.useNewSidebar){this.$element.addClass('ve-ui-mwTransclusionDialog-newSidebar');}};OO.inheritClass(ve.ui.MWTransclusionDialog,ve.ui.MWTemplateDialog);ve.ui.MWTransclusionDialog.static.name='transclusion';ve.ui.MWTransclusionDialog.static.actions=ve.ui.MWTemplateDialog.static.actions.concat([{action:'mode',modes:['edit','insert'],label:$(document.createTextNode('\u00a0'))},{action:'back',label:OO.ui.deferMsg('visualeditor-dialog-action-goback'),modes:['edit','insert'],flags:['safe','back']}]);ve.ui.MWTransclusionDialog.static.bookletLayoutConfig=ve.extendObject({},ve.ui.MWTemplateDialog.static.bookletLayoutConfig,{outlined:!0,editable:!0});ve.ui.MWTransclusionDialog.static.smallScreenMaxWidth=540;ve.ui.MWTransclusionDialog.prototype.onOutlineControlsMove=function(places){var parts=this.transclusionModel.getParts(),itemId=this.
findSelectedPartId();if(itemId){var part=this.transclusionModel.getPartFromId(itemId);var promise=this.transclusionModel.addPart(part,parts.indexOf(part)+places);if(this.loaded&&!this.preventReselection){promise.done(this.focusPart.bind(this,part.getId()));}}};ve.ui.MWTransclusionDialog.prototype.onOutlineControlsRemove=function(){var id=this.findSelectedPartId();if(id){var part=this.transclusionModel.getPartFromId(id);if(part instanceof ve.dm.MWTemplateModel&&id!==part.getId()){var param=part.getParameterFromId(id);if(param instanceof ve.dm.MWParameterModel){part.removeParameter(param);}}else if(part instanceof ve.dm.MWTransclusionPartModel){this.transclusionModel.removePart(part);}}};ve.ui.MWTransclusionDialog.prototype.onBookletLayoutFocus=function(){var currentPage=this.bookletLayout.getCurrentPage(),isParameterPage=currentPage instanceof ve.ui.MWParameterPage;this.bookletLayout.getOutlineControls().removeButton.setDisabled(isParameterPage);};ve.ui.MWTransclusionDialog.prototype.
onAddTemplateButtonClick=function(){this.addPart(new ve.dm.MWTemplatePlaceholderModel(this.transclusionModel));};ve.ui.MWTransclusionDialog.prototype.onAddContentButtonClick=function(){this.addPart(new ve.dm.MWTransclusionContentModel(this.transclusionModel));};ve.ui.MWTransclusionDialog.prototype.onAddParameterButtonClick=function(){var partId=this.findSelectedPartId();if(!partId){return;}var part=this.transclusionModel.getPartFromId(partId);if(!(part instanceof ve.dm.MWTemplateModel)){return;}part.addParameter(new ve.dm.MWParameterModel(part));};ve.ui.MWTransclusionDialog.prototype.onBookletLayoutSet=function(page){var isPlaceholder=page instanceof ve.ui.MWTemplatePlaceholderPage,acceptsNewParameters=page instanceof ve.ui.MWTemplatePage||page instanceof ve.ui.MWParameterPage,isRequired=page instanceof ve.ui.MWParameterPage&&page.parameter.isRequired(),canNotRemove=isRequired||(isPlaceholder&&this.transclusionModel.getParts().length===1);this.addParameterButton.setDisabled(!
acceptsNewParameters||this.isReadOnly());this.bookletLayout.getOutlineControls().removeButton.toggle(!canNotRemove);};ve.ui.MWTransclusionDialog.prototype.onReplacePart=function(removed,added){ve.ui.MWTransclusionDialog.super.prototype.onReplacePart.call(this,removed,added);var parts=this.transclusionModel.getParts();if(parts.length===0){this.addParameterButton.setDisabled(!0);this.addPart(new ve.dm.MWTemplatePlaceholderModel(this.transclusionModel));}this.multipartMessage.toggle(parts.length>1&&this.useNewSidebar);var canCollapse=this.isSingleTemplateTransclusion();this.actions.setAbilities({mode:canCollapse});this.updateActionSet();};ve.ui.MWTransclusionDialog.prototype.isSingleTemplateTransclusion=function(){var parts=this.transclusionModel&&this.transclusionModel.getParts();return parts&&parts.length===1&&(parts[0]instanceof ve.dm.MWTemplateModel||parts[0]instanceof ve.dm.MWTemplatePlaceholderModel);};ve.ui.MWTransclusionDialog.prototype.findSelectedPartId=function(){if(this.
pocSidebar){return this.pocSidebar.findSelectedPartId();}var item=this.bookletLayout.getOutline().findSelectedItem();return item&&item.getData();};ve.ui.MWTransclusionDialog.prototype.getPageFromPart=function(part){var page=ve.ui.MWTransclusionDialog.super.prototype.getPageFromPart.call(this,part);if(!page&&part instanceof ve.dm.MWTransclusionContentModel){return new ve.ui.MWTransclusionContentPage(part,part.getId(),{$overlay:this.$overlay,isReadOnly:this.isReadOnly()});}return page;};ve.ui.MWTransclusionDialog.prototype.autoExpandSidebar=function(){var showSidebar;if(this.useInlineDescriptions){var isSmallScreen=$(window).width()<=this.constructor.static.smallScreenMaxWidth;showSidebar=!isSmallScreen;this.$otherActions.toggleClass('oo-ui-element-hidden',!isSmallScreen);this.$content.toggleClass('ve-ui-mwTransclusionDialog-small-screen',isSmallScreen);}else{showSidebar=!this.isSingleTemplateTransclusion();}this.toggleSidebar(showSidebar);};ve.ui.MWTransclusionDialog.prototype.
toggleSidebar=function(showSidebar){if(this.isSidebarExpanded===showSidebar){return;}this.isSidebarExpanded=showSidebar;this.$content.toggleClass('ve-ui-mwTransclusionDialog-collapsed',!showSidebar).toggleClass('ve-ui-mwTransclusionDialog-expanded',showSidebar);var dialogSizeSidebarExpanded=this.useInlineDescriptions?'larger':'large';var dialogSizeSidebarCollapsed=this.useNewSidebar?dialogSizeSidebarExpanded:'medium';this.ignoreNextWindowResizeEvent=!0;this.setSize(showSidebar?dialogSizeSidebarExpanded:dialogSizeSidebarCollapsed);this.bookletLayout.toggleOutline(showSidebar);this.updateTitle();this.updateModeActionState();this.$content.find('input:focus').trigger('blur');};ve.ui.MWTransclusionDialog.prototype.updateTitle=function(){if(!this.isSingleTemplateTransclusion()){this.title.setLabel(ve.msg('visualeditor-dialog-transclusion-title-edit-transclusion'));}else{ve.ui.MWTransclusionDialog.super.prototype.updateTitle.call(this);}};ve.ui.MWTransclusionDialog.prototype.
updateModeActionState=function(){var parts=this.transclusionModel&&this.transclusionModel.getParts(),isExpanded=this.isSidebarExpanded,label=ve.msg(isExpanded?'visualeditor-dialog-transclusion-collapse-options':'visualeditor-dialog-transclusion-expand-options');this.actions.forEach({actions:['mode']},function(action){action.setLabel(label);action.$button.attr('aria-expanded',isExpanded?1:0);});if(parts){var canCollapse=!(parts[0]instanceof ve.dm.MWTemplatePlaceholderModel)&&(this.useInlineDescriptions||this.isSingleTemplateTransclusion());this.actions.setAbilities({mode:canCollapse});}};ve.ui.MWTransclusionDialog.prototype.addPart=function(part){var parts=this.transclusionModel.getParts(),itemId=this.findSelectedPartId();if(part){var index=itemId?parts.indexOf(this.transclusionModel.getPartFromId(itemId))+1:parts.length;var promise=this.transclusionModel.addPart(part,index);if(this.loaded&&!this.preventReselection){promise.done(this.focusPart.bind(this,part.getId()));}}};ve.ui.
MWTransclusionDialog.prototype.getActionProcess=function(action){if(action==='back'){if(!this.containsValuableData()){return this.getActionProcess('reset');}return new OO.ui.Process(function(){this.resetConfirmation.toggle(!0);},this);}if(action==='reset'){return new OO.ui.Process(function(){this.resetDialog();},this);}if(action==='mode'){return new OO.ui.Process(function(){this.toggleSidebar(!this.isSidebarExpanded);},this);}return ve.ui.MWTransclusionDialog.super.prototype.getActionProcess.call(this,action);};ve.ui.MWTransclusionDialog.prototype.updateActionSet=function(){var backButton=this.actions.get({flags:['back']}).pop(),saveButton=this.actions.get({actions:['done']}).pop();if(saveButton&&this.getMode()==='edit'){saveButton.setLabel(ve.msg('visualeditor-dialog-transclusion-action-save'));}if(this.useBackButton){var closeButton=this.actions.get({flags:['close']}).pop(),parts=this.transclusionModel&&this.transclusionModel.getParts(),isInitialPage=parts&&parts.length===1&&parts[
0]instanceof ve.dm.MWTemplatePlaceholderModel,isInsertMode=this.getMode()==='insert',isUsingClose=!isInsertMode||isInitialPage;closeButton.toggle(isUsingClose);backButton.toggle(!isUsingClose);}else{backButton.toggle(!1);}};ve.ui.MWTransclusionDialog.prototype.resetConfirmationHide=function(){this.resetConfirmation.toggle(!1);};ve.ui.MWTransclusionDialog.prototype.resetConfirmationReset=function(){this.resetConfirmationHide();this.executeAction('reset');};ve.ui.MWTransclusionDialog.prototype.resetDialog=function(){var target=this;this.transclusionModel.reset();if(this.pocSidebar){this.pocSidebar.clear();}this.bookletLayout.clearPages();this.transclusionModel.addPart(new ve.dm.MWTemplatePlaceholderModel(this.transclusionModel),0).done(function(){target.autoExpandSidebar();target.updateModeActionState();});};ve.ui.MWTransclusionDialog.prototype.containsValuableData=function(){return this.transclusionModel.getParts().some(function(part){return part.containsValuableData();});};ve.ui.
MWTransclusionDialog.prototype.initialize=function(){ve.ui.MWTransclusionDialog.super.prototype.initialize.call(this);this.addTemplateButton=new OO.ui.ButtonWidget({framed:!1,icon:'puzzle',title:ve.msg('visualeditor-dialog-transclusion-add-template')});this.addContentButton=new OO.ui.ButtonWidget({framed:!1,icon:'wikiText',title:ve.msg(this.useNewSidebar?'visualeditor-dialog-transclusion-add-wikitext':'visualeditor-dialog-transclusion-add-content')});this.addParameterButton=new OO.ui.ButtonWidget({framed:!1,icon:'parameter',title:ve.msg('visualeditor-dialog-transclusion-add-param')});this.bookletLayout.getOutlineControls().addItems([this.addTemplateButton,this.addContentButton]);if(!this.useNewSidebar){this.bookletLayout.getOutlineControls().addItems([this.addParameterButton]);}this.multipartMessage=new OO.ui.MessageWidget({label:ve.msg('visualeditor-dialog-transclusion-multipart-message'),classes:['ve-ui-mwTransclusionDialog-multipart-message']});if(this.useInlineDescriptions
){this.getManager().connect(this,{resize:ve.debounce(this.onWindowResize.bind(this))});}this.bookletLayout.connect(this,{set:'onBookletLayoutSet'});this.bookletLayout.$menu.find('[ role="listbox" ]').first().attr('aria-label',ve.msg('visualeditor-dialog-transclusion-templates-menu-aria-label'));this.addTemplateButton.connect(this,{click:'onAddTemplateButtonClick'});this.addContentButton.connect(this,{click:'onAddContentButtonClick'});this.addParameterButton.connect(this,{click:'onAddParameterButtonClick'});this.bookletLayout.getOutlineControls().connect(this,{move:'onOutlineControlsMove',remove:'onOutlineControlsRemove'});if(this.useNewSidebar){this.bookletLayout.$element.on('focusin',this.onBookletLayoutFocus.bind(this));this.bookletLayout.stackLayout.$element.prepend(this.multipartMessage.$element);}};ve.ui.MWTransclusionDialog.prototype.getSetupProcess=function(data){return ve.ui.MWTransclusionDialog.super.prototype.getSetupProcess.call(this,data).next(function(){var isReadOnly=this
.isReadOnly();this.addTemplateButton.setDisabled(isReadOnly);this.addContentButton.setDisabled(isReadOnly);this.addParameterButton.setDisabled(isReadOnly);this.bookletLayout.getOutlineControls().setAbilities({move:!isReadOnly,remove:!isReadOnly});if(this.useNewSidebar){this.bookletLayout.getOutlineControls().toggle(!this.isSingleTemplateTransclusion());this.$element.toggleClass('ve-ui-mwTransclusionDialog-single-transclusion',this.isSingleTemplateTransclusion());}this.updateModeActionState();this.autoExpandSidebar();},this);};ve.ui.MWTransclusionDialog.prototype.onWindowResize=function(){if(!this.ignoreNextWindowResizeEvent){this.autoExpandSidebar();}this.ignoreNextWindowResizeEvent=!1;};ve.ui.MWTransclusionDialog.prototype.getSizeProperties=function(){var sizeProps=ve.ui.MWTransclusionDialog.super.prototype.getSizeProperties.call(this);if(this.useInlineDescriptions){sizeProps=ve.extendObject({height:'90%'},sizeProps);}return sizeProps;};ve.ui.windowFactory.register(ve.ui.
MWTransclusionDialog);ve.ui.MWTransclusionDialogTool=function VeUiMWTransclusionDialogTool(){ve.ui.MWTransclusionDialogTool.super.apply(this,arguments);};OO.inheritClass(ve.ui.MWTransclusionDialogTool,ve.ui.FragmentWindowTool);ve.ui.MWTransclusionDialogTool.static.name='transclusion';ve.ui.MWTransclusionDialogTool.static.group='object';ve.ui.MWTransclusionDialogTool.static.icon='puzzle';ve.ui.MWTransclusionDialogTool.static.title=OO.ui.deferMsg('visualeditor-dialogbutton-template-tooltip');ve.ui.MWTransclusionDialogTool.static.modelClasses=[ve.dm.MWTransclusionNode];ve.ui.MWTransclusionDialogTool.static.commandName='transclusion';ve.ui.MWTransclusionDialogTool.static.template=null;ve.ui.MWTransclusionDialogTool.static.isCompatibleWith=function(model){var compatible=ve.ui.MWTransclusionDialogTool.super.static.isCompatibleWith.call(this,model);if(compatible&&this.template){return model.isSingleTemplate(this.template);}return compatible;};ve.ui.toolFactory.register(ve.ui.
MWTransclusionDialogTool);ve.ui.commandRegistry.register(new ve.ui.Command('transclusion','window','open',{args:['transclusion'],supportedSelections:['linear']}));ve.ui.commandRegistry.register(new ve.ui.Command('transclusionFromSequence','window','open',{args:['transclusion',{cancelCommand:'undo'}],supportedSelections:['linear']}));ve.ui.sequenceRegistry.register(new ve.ui.Sequence('wikitextTemplate','transclusionFromSequence','{{',2));ve.ui.commandHelpRegistry.register('insert','template',{sequences:['wikitextTemplate'],label:OO.ui.deferMsg('visualeditor-dialog-template-title')});ve.ui.MWTransclusionContextItem=function VeUiMWTransclusionContextItem(){ve.ui.MWTransclusionContextItem.super.apply(this,arguments);this.$element.addClass('ve-ui-mwTransclusionContextItem');if(!this.model.isSingleTemplate()){this.setLabel(ve.msg('visualeditor-dialogbutton-transclusion-tooltip'));}};OO.inheritClass(ve.ui.MWTransclusionContextItem,ve.ui.LinearContextItem);ve.ui.MWTransclusionContextItem.
static.name='transclusion';ve.ui.MWTransclusionContextItem.static.icon='puzzle';ve.ui.MWTransclusionContextItem.static.label=OO.ui.deferMsg('visualeditor-dialogbutton-template-tooltip');ve.ui.MWTransclusionContextItem.static.modelClasses=[ve.dm.MWTransclusionNode];ve.ui.MWTransclusionContextItem.static.commandName='transclusion';ve.ui.MWTransclusionContextItem.static.template=null;ve.ui.MWTransclusionContextItem.static.isCompatibleWith=ve.ui.MWTransclusionDialogTool.static.isCompatibleWith;ve.ui.MWTransclusionContextItem.prototype.isDeletable=function(){var veConfig=mw.config.get('wgVisualEditorConfig');return veConfig.transclusionDialogBackButton;};ve.ui.MWTransclusionContextItem.prototype.getDescription=function(){var nodeClass=ve.ce.nodeFactory.lookup(this.model.constructor.static.name);return ve.msg('visualeditor-dialog-transclusion-contextitem-description',nodeClass.static.getDescription(this.model),nodeClass.static.getTemplatePartDescriptions(this.model).length);};ve.ui.
MWTransclusionContextItem.prototype.onEditButtonClick=function(){var surfaceModel=this.context.getSurface().getModel(),selection=surfaceModel.getSelection();if(selection instanceof ve.dm.TableSelection){surfaceModel.setLinearSelection(selection.getOuterRanges(surfaceModel.getDocument())[0]);}ve.ui.MWTransclusionContextItem.super.prototype.onEditButtonClick.apply(this,arguments);};ve.ui.contextItemFactory.register(ve.ui.MWTransclusionContextItem);ve.ui.MWDefinedTransclusionContextItem=function VeUiMWDefinedTransclusionContextItem(){ve.ui.MWDefinedTransclusionContextItem.super.apply(this,arguments);this.tool=this.constructor.static.getMatchedTool(this.model);};OO.inheritClass(ve.ui.MWDefinedTransclusionContextItem,ve.ui.MWTransclusionContextItem);ve.ui.MWDefinedTransclusionContextItem.static.name=null;ve.ui.MWDefinedTransclusionContextItem.static.toolDefinitions=(function(){var tools;try{tools=JSON.parse(mw.message('visualeditor-template-tools-definition.json').plain());}catch(e){}return tools
||{};}());ve.ui.MWDefinedTransclusionContextItem.static.template=null;ve.ui.MWDefinedTransclusionContextItem.static.isCompatibleWith=function(model){return ve.ui.MWDefinedTransclusionContextItem.super.static.isCompatibleWith.apply(this,arguments)&&!!this.getMatchedTool(model);};ve.ui.MWDefinedTransclusionContextItem.static.getToolsByTitle=function(){var toolsByTitle;if(!this.toolsByTitle){this.toolsByTitle=toolsByTitle={};(this.toolDefinitions[this.name]||[]).forEach(function(template){var titles=Array.isArray(template.title)?template.title:[template.title];titles.forEach(function(title){toolsByTitle[mw.Title.newFromText(title,mw.config.get('wgNamespaceIds').template).getPrefixedText()]=template;});});}return this.toolsByTitle;};ve.ui.MWDefinedTransclusionContextItem.static.getMatchedTool=function(model){var resource,title;resource=ve.getProp(model.getAttribute('mw'),'parts',0,'template','target','href');if(resource){title=mw.Title.newFromText(mw.libs.ve.normalizeParsoidResourceName(
resource)).getPrefixedText();return this.getToolsByTitle()[title]||null;}return null;};ve.ui.MWDefinedTransclusionContextItem.prototype.getCanonicalParam=function(name){var aliases,i,value,params=this.tool.params||{};if(Object.prototype.hasOwnProperty.call(params,name)){aliases=Array.isArray(params[name])?params[name]:[params[name]];for(i=0;i<aliases.length;i++){value=ve.getProp(this.model.getAttribute('mw'),'parts',0,'template','params',aliases[i],'wt');if(value){return value;}}}return null;};ve.ui.MWTransclusionOutlineParameterWidget=function VeUiMWTransclusionOutlineParameterWidget(config){this.checkbox=new OO.ui.CheckboxInputWidget({title:config.required?ve.msg('visualeditor-dialog-transclusion-required-parameter'):null,disabled:config.required,selected:config.selected||config.required,tabIndex:-1}).connect(this,{change:['emit','change']});this.checkbox.$input.on({mousedown:this.onMouseDown.bind(this)});ve.ui.MWTransclusionOutlineParameterWidget.super.call(this,ve.extendObject(
config,{classes:['ve-ui-mwTransclusionOutlineParameterWidget'],$label:$('<label>')}));this.$element.append(this.checkbox.$element,this.$label);};OO.inheritClass(ve.ui.MWTransclusionOutlineParameterWidget,OO.ui.OptionWidget);ve.ui.MWTransclusionOutlineParameterWidget.prototype.onMouseDown=function(e){e.stopPropagation();};ve.ui.MWTransclusionOutlineParameterWidget.prototype.setSelected=function(state){state=state||this.checkbox.isDisabled();this.checkbox.setSelected(state,!0);ve.ui.MWTransclusionOutlineParameterWidget.super.prototype.setSelected.call(this,state);return this;};ve.ui.MWTransclusionOutlineButtonWidget=function VeUiMWTransclusionOutlineButtonWidget(config){ve.ui.MWTransclusionOutlineButtonWidget.super.call(this,ve.extendObject(config,{classes:['ve-ui-mwTransclusionOutlineButtonWidget']}));OO.ui.mixin.ButtonElement.call(this,{framed:!1});OO.ui.mixin.IconElement.call(this,config);OO.ui.mixin.TabIndexedElement.call(this,ve.extendObject({$tabIndexed:this.$button},config));
this.$element.append(this.$button.append(this.$icon,this.$label));};OO.inheritClass(ve.ui.MWTransclusionOutlineButtonWidget,OO.ui.OptionWidget);OO.mixinClass(ve.ui.MWTransclusionOutlineButtonWidget,OO.ui.mixin.ButtonElement);OO.mixinClass(ve.ui.MWTransclusionOutlineButtonWidget,OO.ui.mixin.IconElement);OO.mixinClass(ve.ui.MWTransclusionOutlineButtonWidget,OO.ui.mixin.TabIndexedElement);ve.ui.MWTransclusionOutlineButtonWidget.static.highlightable=!1;ve.ui.MWTransclusionOutlineButtonWidget.static.pressable=!1;ve.ui.MWTransclusionOutlineButtonWidget.prototype.onKeyPress=function(e){if(e.which===OO.ui.Keys.SPACE){if(!this.isSelected()){this.emit('spacePressed');}e.preventDefault();return;}return OO.ui.mixin.ButtonElement.prototype.onKeyPress.call(this,e);};ve.ui.MWTransclusionOutlinePartWidget=function VeUiMWTransclusionOutlinePartWidget(part,config){ve.ui.MWTransclusionOutlinePartWidget.super.call(this,ve.extendObject(config,{classes:['ve-ui-mwTransclusionOutlinePartWidget'],data:
part.getId()}));this.header=new ve.ui.MWTransclusionOutlineButtonWidget(config).connect(this,{spacePressed:['emit','transclusionPartSoftSelected',part.getId()],click:['emit','transclusionPartSelected',part.getId()]});this.$element.append(this.header.$element);};OO.inheritClass(ve.ui.MWTransclusionOutlinePartWidget,OO.ui.Widget);ve.ui.MWTransclusionOutlinePartWidget.prototype.isSelected=function(){return this.header.isSelected();};ve.ui.MWTransclusionOutlinePartWidget.prototype.setSelected=function(state){this.header.setSelected(state).setFlags({progressive:state});};ve.ui.MWTransclusionOutlineTemplateWidget=function VeUiMWTransclusionOutlineTemplateWidget(template){var spec=template.getSpec();ve.ui.MWTransclusionOutlineTemplateWidget.super.call(this,template,{icon:'puzzle',label:spec.getLabel()});this.templateModel=template.connect(this,{add:'onParameterAddedToTemplateModel',remove:'onParameterRemovedFromTemplateModel'});var parameterNames=this.templateModel.getAllParametersOrdered().
filter(function(paramName){if(spec.isParameterDeprecated(paramName)&&!template.hasParameter(paramName)){return!1;}return paramName;});this.searchWidget=new OO.ui.SearchInputWidget({placeholder:ve.msg('visualeditor-dialog-transclusion-filter-placeholder'),classes:['ve-ui-mwTransclusionOutlineTemplateWidget-searchWidget']}).connect(this,{change:'filterParameters'}).toggle(parameterNames.length);this.infoWidget=new OO.ui.LabelWidget({label:new OO.ui.HtmlSnippet(ve.msg('visualeditor-dialog-transclusion-filter-no-match')),classes:['ve-ui-mwTransclusionOutlineTemplateWidget-no-match']}).toggle(!1);this.parameters=new ve.ui.MWTransclusionOutlineParameterSelectWidget({items:parameterNames.map(this.createCheckbox.bind(this))}).connect(this,{choose:'onTemplateParameterChoose',templateParameterSelectionChanged:'onTemplateParameterSelectionChanged',templateParameterClick:'onTemplateParameterClick',change:'onParameterWidgetListChanged'});this.$element.append(this.searchWidget.$element,this.
infoWidget.$element,this.parameters.$element);};OO.inheritClass(ve.ui.MWTransclusionOutlineTemplateWidget,ve.ui.MWTransclusionOutlinePartWidget);ve.ui.MWTransclusionOutlineTemplateWidget.prototype.createCheckbox=function(paramName){var spec=this.templateModel.getSpec();return ve.ui.MWTransclusionOutlineParameterSelectWidget.static.createItem({required:spec.isParameterRequired(paramName),label:spec.getParameterLabel(paramName),data:paramName,selected:this.templateModel.hasParameter(paramName)});};ve.ui.MWTransclusionOutlineTemplateWidget.prototype.findCanonicalPosition=function(paramName){var insertAt=0,allParamNames=this.templateModel.getAllParametersOrdered();for(var i=0;i<allParamNames.length;i++){if(allParamNames[i]===paramName||!this.parameters.items[insertAt]){break;}else if(this.parameters.items[insertAt].getData()===allParamNames[i]){insertAt++;}}return insertAt;};ve.ui.MWTransclusionOutlineTemplateWidget.prototype.highlightParameter=function(paramName){this.parameters.
highlightParameter(paramName);};ve.ui.MWTransclusionOutlineTemplateWidget.prototype.onParameterAddedToTemplateModel=function(param){var paramName=param.getName();if(!paramName){return;}var item=this.parameters.findItemFromData(paramName);if(!item){item=this.createCheckbox(paramName);this.parameters.addItems([item],this.findCanonicalPosition(paramName));var filter=this.searchWidget.getValue();if(filter){this.filterParameters(filter);}}item.setSelected(!0,!0);if(!item.isVisible()){this.searchWidget.setValue('');}};ve.ui.MWTransclusionOutlineTemplateWidget.prototype.onParameterRemovedFromTemplateModel=function(param){this.parameters.markParameterAsUnused(param.getName());};ve.ui.MWTransclusionOutlineTemplateWidget.prototype.onTemplateParameterChoose=function(item,selected){this.onTemplateParameterSelectionChanged(item,selected);var param=this.templateModel.getParameter(item.getData());if(param){this.emit('focusTemplateParameterById',param.getId());}};ve.ui.
MWTransclusionOutlineTemplateWidget.prototype.onTemplateParameterSelectionChanged=function(item,selected){var paramName=item.getData(),param=this.templateModel.getParameter(paramName);if(!selected){this.templateModel.removeParameter(param);}else if(!param){param=new ve.dm.MWParameterModel(this.templateModel,paramName);this.templateModel.addParameter(param);}};ve.ui.MWTransclusionOutlineTemplateWidget.prototype.onTemplateParameterClick=function(item,selected){if(!selected){return;}var paramName=item.getData(),param=this.templateModel.getParameter(paramName);if(param){this.emit('focusTemplateParameterById',param.getId());}};ve.ui.MWTransclusionOutlineTemplateWidget.prototype.onParameterWidgetListChanged=function(items){this.searchWidget.toggle(items.length>=1);};ve.ui.MWTransclusionOutlineTemplateWidget.prototype.filterParameters=function(query){var self=this,template=this.templateModel,spec=this.templateModel.getSpec(),visibility={},nothingFound=!0;query=query.trim().toLowerCase();
this.parameters.items.forEach(function(item){var paramName=item.getData(),placesToSearch=[spec.getPrimaryParameterName(paramName),spec.getParameterLabel(paramName),spec.getParameterDescription(paramName)].concat(spec.getParameterAliases(paramName));var foundSomeMatch=placesToSearch.some(function(term){return term&&term.toLowerCase().indexOf(query)!==-1;});item.toggle(foundSomeMatch);nothingFound=nothingFound&&!foundSomeMatch;var param=template.getParameter(paramName);if(param){visibility[param.getId()]=foundSomeMatch;}});this.infoWidget.toggle(nothingFound);self.emit('filterParametersById',visibility);};ve.ui.MWTransclusionOutlineContainerWidget=function VeUiMWTransclusionOutlineContainerWidget(){ve.ui.MWTransclusionOutlineContainerWidget.super.call(this,{classes:['ve-ui-mwTransclusionOutlineContainerWidget']});this.partWidgets={};};OO.inheritClass(ve.ui.MWTransclusionOutlineContainerWidget,OO.ui.Widget);ve.ui.MWTransclusionOutlineContainerWidget.prototype.onReplacePart=function(
removed,added,newPosition){if(removed){this.removePartWidget(removed);}if(added){this.addPartWidget(added,newPosition);}};ve.ui.MWTransclusionOutlineContainerWidget.prototype.onTransclusionModelChange=function(transclusionModel){var newOrder=transclusionModel.getParts();for(var i=0;i<newOrder.length;i++){var expectedWidget=this.partWidgets[newOrder[i].getId()],$expectedElement=expectedWidget&&expectedWidget.$element,$currentElement=this.$element.children().eq(i);if(!$currentElement.is($expectedElement)){$currentElement.before($expectedElement);}}};ve.ui.MWTransclusionOutlineContainerWidget.prototype.onTransclusionPartSelected=function(partId){this.selectPartById(partId);this.emit('focusPageByName',partId);};ve.ui.MWTransclusionOutlineContainerWidget.prototype.removePartWidget=function(part){var id=part.getId();if(id in this.partWidgets){this.partWidgets[id].disconnect(this).$element.remove();delete this.partWidgets[id];}};ve.ui.MWTransclusionOutlineContainerWidget.prototype.
addPartWidget=function(part,newPosition){var widget;if(part instanceof ve.dm.MWTemplateModel){widget=new ve.ui.MWTransclusionOutlineTemplateWidget(part);widget.connect(this,{focusTemplateParameterById:['emit','focusPageByName'],filterParametersById:['emit','filterPagesByName']});}else if(part instanceof ve.dm.MWTemplatePlaceholderModel){widget=new ve.ui.MWTransclusionOutlinePlaceholderWidget(part);}else if(part instanceof ve.dm.MWTransclusionContentModel){widget=new ve.ui.MWTransclusionOutlineWikitextWidget(part);}widget.connect(this,{transclusionPartSoftSelected:'selectPartById',transclusionPartSelected:'onTransclusionPartSelected'});this.partWidgets[part.getId()]=widget;if(typeof newPosition==='number'&&newPosition<this.$element.children().length){this.$element.children().eq(newPosition).before(widget.$element);}else{this.$element.append(widget.$element);}};ve.ui.MWTransclusionOutlineContainerWidget.prototype.selectPartById=function(partId){for(var id in this.partWidgets){this.
partWidgets[id].setSelected(id===partId);}this.emit('updateOutlineControlButtons',partId);};ve.ui.MWTransclusionOutlineContainerWidget.prototype.highlightSubItemByPageName=function(pageName){var partId=pageName.split('/',1)[0],partWidget=this.partWidgets[partId];if(partWidget instanceof ve.ui.MWTransclusionOutlineTemplateWidget&&pageName.length>partId.length){var paramName=pageName.slice(partId.length+1);partWidget.highlightParameter(paramName);}};ve.ui.MWTransclusionOutlineContainerWidget.prototype.findSelectedPartId=function(){for(var id in this.partWidgets){var part=this.partWidgets[id];if(part.isSelected()){return part.getData();}}};ve.ui.MWTransclusionOutlineContainerWidget.prototype.clear=function(){for(var id in this.partWidgets){this.partWidgets[id].disconnect(this).$element.remove();}this.partWidgets={};};ve.ui.MWTransclusionOutlineParameterSelectWidget=function VeUiMWTransclusionOutlineParameterSelectWidget(config){ve.ui.MWTransclusionOutlineParameterSelectWidget.super.call(
this,ve.extendObject(config,{classes:['ve-ui-mwTransclusionOutlineParameterSelectWidget'],multiselect:!0}));OO.ui.mixin.TabIndexedElement.call(this,{tabIndex:this.isEmpty()?-1:0});this.$element.on({focus:this.bindDocumentKeyDownListener.bind(this),blur:this.unbindDocumentKeyDownListener.bind(this)});};OO.inheritClass(ve.ui.MWTransclusionOutlineParameterSelectWidget,OO.ui.SelectWidget);OO.mixinClass(ve.ui.MWTransclusionOutlineParameterSelectWidget,OO.ui.mixin.TabIndexedElement);ve.ui.MWTransclusionOutlineParameterSelectWidget.static.createItem=function(config){return new ve.ui.MWTransclusionOutlineParameterWidget(config);};ve.ui.MWTransclusionOutlineParameterSelectWidget.prototype.addItems=function(items,index){var self=this;items.forEach(function(item){item.connect(self,{change:['onCheckboxChange',item]});});ve.ui.MWTransclusionOutlineParameterSelectWidget.super.prototype.addItems.call(this,items,index);this.setTabIndex(this.isEmpty()?-1:0);return this;};ve.ui.
MWTransclusionOutlineParameterSelectWidget.prototype.highlightParameter=function(paramName){var item=this.findItemFromData(paramName);this.highlightItem(item);if(item){this.scrollItemIntoView(item);}};ve.ui.MWTransclusionOutlineParameterSelectWidget.prototype.markParameterAsUnused=function(paramName){var item=this.findItemFromData(paramName);if(item){item.setSelected(!1);}};ve.ui.MWTransclusionOutlineParameterSelectWidget.prototype.onCheckboxChange=function(item,value){if(item.isSelected()!==value){this.chooseItem(item);}};ve.ui.MWTransclusionOutlineParameterSelectWidget.prototype.onFocus=function(){if(!this.findHighlightedItem()){this.highlightItem(this.items[0]);}};ve.ui.MWTransclusionOutlineParameterSelectWidget.prototype.onMouseDown=function(e){if(e.which===OO.ui.MouseButtons.LEFT){var item=this.findTargetItem(e);if(item&&item.isSelected()){this.emit('templateParameterClick',item,item.isSelected());return!1;}}ve.ui.MWTransclusionOutlineParameterSelectWidget.super.prototype.
onMouseDown.call(this,e);};ve.ui.MWTransclusionOutlineParameterSelectWidget.prototype.onDocumentKeyDown=function(e){var item;switch(e.keyCode){case OO.ui.Keys.HOME:item=this.items[0];if(item){this.highlightItem(item);}break;case OO.ui.Keys.END:item=this.items[this.items.length-1];if(item){this.highlightItem(item);}break;case OO.ui.Keys.SPACE:item=this.findHighlightedItem();if(item){this[item.isSelected()?'unselectItem':'selectItem'](item);this.emit('templateParameterSelectionChanged',item,item.isSelected());}e.preventDefault();break;case OO.ui.Keys.ENTER:item=this.findHighlightedItem();if(item&&item.isSelected()){this.emit('templateParameterClick',item,item.isSelected());e.preventDefault();return!1;}break;}ve.ui.MWTransclusionOutlineParameterSelectWidget.super.prototype.onDocumentKeyDown.call(this,e);};ve.ui.MWTransclusionOutlinePlaceholderWidget=function VeUiMWTransclusionOutlinePlaceholderWidget(placeholder){var label=placeholder.getTransclusion().getParts().length===1?ve.msg(
'visualeditor-dialog-transclusion-template-search'):ve.msg('visualeditor-dialog-transclusion-add-template');ve.ui.MWTransclusionOutlinePlaceholderWidget.super.call(this,placeholder,{icon:'puzzle',label:label});};OO.inheritClass(ve.ui.MWTransclusionOutlinePlaceholderWidget,ve.ui.MWTransclusionOutlinePartWidget);ve.ui.MWTransclusionOutlineWikitextWidget=function VeUiMWTransclusionOutlineWikitextWidget(content){ve.ui.MWTransclusionOutlineWikitextWidget.super.call(this,content,{icon:'wikiText',label:ve.msg('visualeditor-dialog-transclusion-wikitext')});};OO.inheritClass(ve.ui.MWTransclusionOutlineWikitextWidget,ve.ui.MWTransclusionOutlinePartWidget);},{"css":[
".ve-ce-mwTransclusionNode \u003E .ve-ce-focusableNode-invisibleIcon.oo-ui-iconElement{font-size:1em;width:auto}.ve-ce-mwTransclusionNode.ve-ce-focusableNode-invisible{width:auto}.ve-ui-dismissibleMessageWidget.oo-ui-messageWidget-block{padding-right:48px}.ve-ui-dismissibleMessageWidget .oo-ui-buttonElement{margin-right:0; position:absolute;right:2px;top:2px} .ve-ui-mwParameterResultWidget{padding-right:0.25em}.ve-ui-mwParameterResultWidget.oo-ui-optionWidget-highlighted{background-color:#e1f3ff}.ve-ui-mwParameterResultWidget .oo-ui-optionWidget-icon{top:0.25em;margin-top:0}.ve-ui-mwParameterResultWidget-label,.ve-ui-mwParameterResultWidget-names,.ve-ui-mwParameterResultWidget-description{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:100%}.ve-ui-mwParameterResultWidget-label{font-weight:bold;float:left}.ve-ui-mwParameterResultWidget-names{float:right;font-size:0.9em;padding:0.2em 0}.ve-ui-mwParameterResultWidget-name{padding:0.1em 0.25em;margin-left:0.5em;color:#54595d;background-color:#fff;border:1px solid #c8ccd1;border-radius:2px}.ve-ui-mwParameterResultWidget-name.ve-ui-mwParameterResultWidget-alias{background-color:#eaecf0}.ve-ui-mwParameterResultWidget-description{clear:both;color:#54595d}.ve-ui-mwParameterResultWidget-description.ve-ui-mwParameterResultWidget-unknown{font-style:italic} .ve-ui-mwMoreParametersResultWidget{padding-right:0.25em}.ve-ui-mwMoreParametersResultWidget.oo-ui-optionWidget-highlighted{background-color:#e1f3ff}.ve-ui-mwMoreParametersResultWidget .oo-ui-optionWidget-icon{top:0.25em;margin-top:0}.ve-ui-mwMoreParametersResultWidget-label{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:100%;font-weight:bold;float:left} .ve-ui-mwNoParametersResultWidget-label{text-align:center;white-space:nowrap;text-overflow:ellipsis;overflow:hidden} .ve-ui-mwParameterSearchWidget .oo-ui-selectWidget{position:relative;width:100%}.ve-ui-mwParameterSearchWidget .oo-ui-searchWidget-results{overflow-y:hidden} .ve-ui-mwTransclusionContentPage .oo-ui-textInputWidget{display:block;width:100%}.ve-ui-mwTransclusionContentPage .oo-ui-textInputWidget textarea{height:2.5em} .ve-ui-mwParameterPage .ve-ui-mwParameter-wikitextFallbackInput{  font-family:monospace,monospace;background-color:#c8ccd1}.ve-ui-mwParameterPage-warning{color:#202122; font-weight:normal;margin-top:0.5em}.ve-ui-mwParameterPage-warning .oo-ui-iconElement-icon{opacity:0.87}.ve-ui-mwParameterPage-info{margin-bottom:0.5em}.ve-ui-mwParameterPage-inlineDescription{position:relative}.ve-ui-mwParameterPage-undocumentedLabel{margin-left:0.4em;font-size:13px;font-style:italic;color:#72777d} .ve-ui-mwTransclusionDialog-addTemplateFieldset \u003E .oo-ui-widget{display:inline-block}.ve-ui-mwTransclusionDialog-addTemplateFieldset \u003E .oo-ui-buttonElement-framed{margin-left:0.5em}.ve-ui-mwTransclusionDialog-addTemplateFieldset .mw-widget-titleInputWidget{min-width:10em}.ve-ui-mwTransclusionDialog-addParameterFieldset .ve-ui-mwParameterSearchWidget{position:relative;overflow:hidden;margin-bottom:1em}.ve-ui-mwTransclusionDialog-addParameterFieldset .oo-ui-searchWidget-results{position:relative;padding-bottom:5em}.ve-ui-mwTransclusionDialog-addParameterFieldset-collapsed .oo-ui-inline-help,.ve-ui-mwTransclusionDialog-addParameterFieldset-collapsed .ve-ui-mwTransclusionDialog-addParameterFieldset-input{display:none}.ve-ui-mwTransclusionDialog-addParameterFieldset-input{margin-top:8px}.ve-ui-mwTransclusionDialog-addParameterFieldset-input .oo-ui-fieldLayout-field{width:100%}.ve-ui-mwTransclusionDialog-addParameterFieldset .oo-ui-fieldLayout-messages .oo-ui-messageWidget{margin-left:0;margin-right:0}.ve-ui-mwTransclusionDialog-addParameterFieldset-header.oo-ui-iconElement .oo-ui-iconElement-icon{height:100%}.ve-ui-mwTransclusionDialog-removeButton{position:absolute;top:0.85714286em; right:1.5em}.ve-ui-mwTransclusionDialog-addButton{white-space:nowrap}.ve-ui-mwTransclusionDialog-enhancedSearch .mw-widget-titleWidget-menu-withDescriptions .mw-widget-titleOptionWidget .oo-ui-labelElement-label{font-weight:bold}.ve-ui-mwTransclusionDialog-enhancedSearch .mw-widget-titleWidget-menu-withDescriptions .mw-widget-titleOptionWidget .oo-ui-labelElement-label .oo-ui-labelElement-label-highlight{font-weight:normal}.ve-ui-mwTemplateTitleInputWidget-redirectedfrom{font-style:italic}.ve-ui-mwTemplateDialog-pocSidebar-debug-container{position:absolute;top:0;left:0;right:0;bottom:2.5em;overflow:auto}.ve-ui-mwTransclusionDialog-single-transclusion .ve-ui-mwTemplateDialog-pocSidebar-debug-container{bottom:0}.ve-ui-mwTemplateDialog-pocSidebar-debug-container \u003E .oo-ui-outlineSelectWidget{background-color:rgba(100%,0%,100%,0.1);height:auto;outline:1px solid #f0f}.ve-ui-mwTemplateDialog .oo-ui-outlineOptionWidget.oo-ui-flaggedElement-empty .oo-ui-iconElement-icon{opacity:0.51}.ve-ui-mwTemplateDialog .oo-ui-outlineOptionWidget.oo-ui-flaggedElement-empty .oo-ui-labelElement-label{color:#72777d}.ve-ui-mwTransclusionDialog .oo-ui-bookletLayout .oo-ui-fieldsetLayout \u003E .oo-ui-labelElement-label{height:1.5em;overflow:hidden}.ve-ui-mwTransclusionDialog-collapsed .oo-ui-bookletLayout .oo-ui-fieldsetLayout \u003E .oo-ui-iconElement-icon,.ve-ui-mwTransclusionDialog-collapsed .oo-ui-bookletLayout .oo-ui-fieldsetLayout \u003E .oo-ui-labelElement-label,.ve-ui-mwTransclusionDialog-collapsed .oo-ui-bookletLayout .ve-ui-mwTransclusionDialog-removeButton,.ve-ui-mwTransclusionDialog-expanded .oo-ui-bookletLayout .ve-ui-mwTemplatePage-more,.ve-ui-mwTransclusionDialog-expanded .oo-ui-bookletLayout .ve-ui-mwParameterPage-addUndocumented{display:none}.ve-ui-mwTransclusionDialog.ve-ui-mwTemplateDialog-ready .oo-ui-bookletLayout .oo-ui-fieldsetLayout \u003E .oo-ui-labelElement-label,.ve-ui-mwTransclusionDialog.ve-ui-mwTemplateDialog-ready .oo-ui-bookletLayout .oo-ui-fieldsetLayout \u003E .oo-ui-iconElement-icon,.ve-ui-mwTransclusionDialog.ve-ui-mwTemplateDialog-ready .oo-ui-bookletLayout .ve-ui-mwTransclusionDialog-removeButton,.ve-ui-mwTransclusionDialog.ve-ui-mwTemplateDialog-ready .oo-ui-bookletLayout .ve-ui-mwTemplatePage-more,.ve-ui-mwTransclusionDialog.ve-ui-mwTemplateDialog-ready .oo-ui-bookletLayout .ve-ui-mwParameterPage-addUndocumented,.ve-ui-mwTransclusionDialog.ve-ui-mwTemplateDialog-ready .oo-ui-bookletLayout \u003E .oo-ui-gridLayout \u003E .oo-ui-panelLayout{-webkit-transition:all 250ms ease-in-out;-moz-transition:all 250ms ease-in-out;transition:all 250ms ease-in-out}.ve-ui-mwTransclusionDialog-bigger .oo-ui-menuLayout \u003E .oo-ui-menuLayout-menu{width:240px}.ve-ui-mwTransclusionDialog-bigger .oo-ui-menuLayout \u003E .oo-ui-menuLayout-content{left:240px}.ve-ui-mwTransclusionDialog-bigger .ve-ui-mwTransclusionDialog-small-screen.ve-ui-mwTransclusionDialog-expanded .oo-ui-menuLayout \u003E .oo-ui-menuLayout-menu{border-right:0;width:100%}.ve-ui-mwTransclusionDialog-bigger .ve-ui-mwTransclusionDialog-small-screen.ve-ui-mwTransclusionDialog-expanded .oo-ui-menuLayout \u003E .oo-ui-menuLayout-content{display:none}.ve-ui-mwTransclusionDialog-addTemplateFieldset .oo-ui-inline-help{color:inherit}.ve-ui-mwTransclusionDialog-collapsed .oo-ui-bookletLayout .ve-ui-mwTransclusionDialog-addTemplateFieldset.oo-ui-fieldsetLayout \u003E .oo-ui-labelElement-label{display:inline-block}.ve-ui-mwTransclusionOutlineContainerWidget{ padding-top:1px}.ve-ui-mwTransclusionOutlineParameterSelectWidget:focus{border-radius:2px;box-shadow:inset 0 0 0 1px #36c;outline:0}.ve-ui-mwTransclusionOutlineParameterWidget{overflow:hidden;padding-bottom:8px;padding-left:24px;padding-top:8px;text-overflow:ellipsis;white-space:nowrap}.ve-ui-mwTransclusionOutlineParameterWidget.oo-ui-labelElement \u003E .oo-ui-labelElement-label{cursor:pointer;display:inline} .ve-ui-mwTransclusionOutlineParameterWidget.oo-ui-optionWidget-selected{ }.ve-ui-mwTransclusionOutlineParameterWidget.oo-ui-optionWidget-highlighted,.ve-ui-mwTransclusionOutlineParameterWidget:hover{ background-color:rgba(0,24,73,0.082)}.ve-ui-mwTransclusionOutlineParameterWidget .oo-ui-checkboxInputWidget.oo-ui-widget-enabled [type='checkbox']:hover + span{ border-width:2px}.ve-ui-mwTransclusionOutlineButtonWidget,.ve-ui-mwTransclusionOutlineButtonWidget \u003E .oo-ui-buttonElement-button{display:block}.ve-ui-mwTransclusionOutlineButtonWidget.oo-ui-buttonElement-frameless.oo-ui-labelElement.oo-ui-iconElement \u003E .oo-ui-buttonElement-button{overflow:hidden;padding:8px 0 8px 36px;text-overflow:ellipsis}.ve-ui-mwTransclusionOutlineButtonWidget.oo-ui-optionWidget-selected .oo-ui-buttonElement-button{background-color:#eaf3ff}.ve-ui-mwTransclusionOutlineButtonWidget.oo-ui-buttonElement-frameless.oo-ui-widget-enabled \u003E .oo-ui-buttonElement-button:hover{background-color:#eaecf0;color:#000}.ve-ui-mwTransclusionOutlineButtonWidget.oo-ui-buttonElement-frameless.oo-ui-widget-enabled \u003E .oo-ui-buttonElement-button:active,.ve-ui-mwTransclusionOutlineParameterWidget:active{ background-color:rgba(41,98,204,0.1);color:#36c}.ve-ui-mwTransclusionOutlineButtonWidget.oo-ui-buttonElement-frameless.oo-ui-iconElement:first-child{margin-left:0}.ve-ui-mwTransclusionOutlineButtonWidget.oo-ui-buttonElement-frameless.oo-ui-iconElement \u003E .oo-ui-buttonElement-button \u003E .oo-ui-iconElement-icon{left:10px}.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-outlineControlsWidget{padding:2px;display:flex;align-items:flex-start;justify-content:left}.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-outlineControlsWidget \u003E .oo-ui-outlineControlsWidget-movers{float:left}.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-outlineControlsWidget .oo-ui-buttonWidget{margin-left:4px !important; }.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-outlineControlsWidget \u003E .oo-ui-outlineControlsWidget-items \u003E .oo-ui-buttonWidget:first-child{margin-left:0 !important; }.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-outlineControlsWidget \u003E .oo-ui-outlineControlsWidget-movers \u003E .oo-ui-buttonWidget:nth-child(2){margin-left:-4px !important; }.ve-ui-mwTransclusionOutlineTemplateWidget-searchWidget{margin:8px 24px;width:auto}.ve-ui-mwTransclusionOutlineTemplateWidget-no-match{font-style:italic;color:#72777d;margin:8px 24px} .ve-ui-mwParameterPage.oo-ui-pageLayout{padding-top:0;padding-bottom:0;position:relative}.ve-ui-mwParameterPage.oo-ui-pageLayout:last-of-type{margin-bottom:1.5em}.ve-ui-mwParameterPage.oo-ui-pageLayout-active .ve-ui-mwParameterPage{background-color:#f8f9fa}.ve-ui-mwParameterPage-info{float:left;cursor:default;padding-left:2.5em;width:80%;box-sizing:border-box}.ve-ui-mwParameterPage-actions{cursor:default;position:absolute;top:-0.3125em;right:4em; width:25%;text-align:right;box-sizing:border-box}.ve-ui-mwParameterPage-label{display:inline;vertical-align:middle;font-size:1.1em;font-weight:bold;line-height:1.705em}.ve-ui-mwParameterPage-statusIndicator{display:inline-block;vertical-align:middle;opacity:0.5}.ve-ui-mwParameterPage-doc{font-size:0.9em;line-height:1.5em;overflow-wrap:break-word;padding:0.25em 1em}.ve-ui-mwParameterPage-inlineDescription .ve-ui-expandableContent-collapsible \u003E :first-child{margin-top:0}.ve-ui-mwParameterPage-inlineDescription .ve-ui-expandableContent-container{right:2.5em}.ve-ui-mwParameterPage-inlineDescription .ve-ui-mwParameterPage-doc{font-size:inherit;padding:0 2.5em;clear:both}.ve-ui-mwParameterPage-doc-required,.ve-ui-mwParameterPage-doc-deprecated,.ve-ui-mwParameterPage-inlineDescription .ve-ui-mwParameterPage-doc-example{font-style:italic;color:#54595d}.ve-ui-mwParameterPage-infoButton,.ve-ui-mwParameterPage-removeButton{display:none}.ve-ui-mwParameterPage-infoButton .oo-ui-popupWidget{z-index:100;text-align:left}.oo-ui-pageLayout-active .ve-ui-mwParameterPage-infoButton,.oo-ui-pageLayout-active .ve-ui-mwParameterPage-removeButton{display:inline-block}.ve-ui-mwParameterPage-field{position:relative;padding:0.25em 2.5em 1em;clear:both}.ve-ui-mwParameterPage-field.ve-ui-mwParameterPage-inlineDescription{padding:0.25em 2.5em 2em}.ve-ui-mwParameterPage .oo-ui-textInputWidget{display:inline-block;vertical-align:top;width:100%;box-sizing:border-box}.ve-ui-mwParameterPage .oo-ui-textInputWidget textarea{height:2.5em}.ve-ui-mwParameterPage-addUndocumented{display:none;margin:1em 0 0.5em 0}.ve-ui-mwParameterPage:last-child .ve-ui-mwParameterPage-addUndocumented{display:block} .ve-ui-mwTemplatePage-more{display:none;margin:2.25em 0 0.5em 0}.ve-ui-mwTemplatePage:last-child .ve-ui-mwTemplatePage-more{display:block}.ve-ui-mwTemplatePage-description{color:#54595d;overflow-wrap:break-word}.ve-ui-mwTemplatePage-description-extra,.ve-ui-mwTemplatePage-description-missing{font-style:italic}.ve-ui-mwTransclusionDialog-newSidebar .ve-ui-mwParameterPage-statusIndicator.oo-ui-indicator-required{display:none}.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-menuLayout-content \u003E .oo-ui-bookletLayout-stackLayout{ padding:0 48px}.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-bookletLayout-stackLayout \u003E .oo-ui-panelLayout,.ve-ui-mwTransclusionDialog-newSidebar .ve-ui-mwParameterPage-doc,.ve-ui-mwTransclusionDialog-newSidebar .ve-ui-mwParameterPage-info,.ve-ui-mwTransclusionDialog-newSidebar .ve-ui-mwParameterPage-field{padding:0}.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-bookletLayout-stackLayout \u003E .oo-ui-panelLayout,.ve-ui-mwTransclusionDialog-newSidebar .ve-ui-mwTransclusionDialog-multipart-message{ margin:48px 0 16px 0}.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-bookletLayout-stackLayout \u003E .ve-ui-mwParameterPage,.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-bookletLayout-stackLayout \u003E .ve-ui-mwParameterPlaceholderPage{ margin-top:16px}.ve-ui-mwTransclusionDialog-newSidebar .oo-ui-bookletLayout-stackLayout \u003E .oo-ui-panelLayout:last-child{margin-bottom:48px}.ve-ui-mwTransclusionDialog-template-note{margin-top:16px}"
]},{"quotation-marks":"\"$1\"","redirectedfrom":"(Redirected from $1)","templatedata-doc-subpage":"doc","visualeditor-changedesc-mwtransclusion":"Template parameters changed","visualeditor-dialog-template-insert":"Insert a template","visualeditor-dialog-template-title":"Template","visualeditor-dialog-transclusion-absent-template":"The \"$1\" template doesn't yet exist.","visualeditor-dialog-transclusion-action-save":"Save","visualeditor-dialog-transclusion-add-content":"Add content","visualeditor-dialog-transclusion-add-param":"Add more information","visualeditor-dialog-transclusion-add-param-error-alias":"\"$1\" is already added as \"$2\". Please check the options in the sidebar. This is due to either the use of [//www.mediawiki.org/wiki/Help:TemplateData#aliases aliases] or [//www.mediawiki.org/wiki/Help:TemplateData#label labels].","visualeditor-dialog-transclusion-add-param-error-deprecated":
"\"$1\" cannot be added because the parameter has been marked as [//www.mediawiki.org/wiki/Help:TemplateData#deprecated deprecated].","visualeditor-dialog-transclusion-add-param-error-exists-selected":"Cannot add two parameters of the same name.","visualeditor-dialog-transclusion-add-param-error-exists-unselected":"This parameter is already available for use. Please check the options in the sidebar.","visualeditor-dialog-transclusion-add-param-error-forbidden-char":"$1 is a forbidden character. Please remove it to add the parameter.","visualeditor-dialog-transclusion-add-param-help":"If known, enter undocumented parameter names. Note that only parameters known by the template will have an effect. You may find information about existing parameters on the [[$1|template's page]].","visualeditor-dialog-transclusion-add-param-placeholder":"Parameter name","visualeditor-dialog-transclusion-add-param-save":"Add parameter","visualeditor-dialog-transclusion-add-template":"Add template",
"visualeditor-dialog-transclusion-add-undocumented-param":"Add undocumented parameter","visualeditor-dialog-transclusion-add-wikitext":"Add wikitext","visualeditor-dialog-transclusion-collapse-options":"Hide options","visualeditor-dialog-transclusion-content":"Content","visualeditor-dialog-transclusion-contextitem-description":"Generated from: $1","visualeditor-dialog-transclusion-deprecated-parameter":"Deprecated field","visualeditor-dialog-transclusion-deprecated-parameter-description":"Field is deprecated. $1","visualeditor-dialog-transclusion-expand-options":"Show options","visualeditor-dialog-transclusion-feedback-message":"Recent work was completed to improve template search results. To learn more about the changes or leave feedback, go to the [//meta.wikimedia.org/wiki/WMDE_Technical_Wishes/Finding_and_inserting_templates project's page].","visualeditor-dialog-transclusion-filter-no-match":"No matches found","visualeditor-dialog-transclusion-filter-placeholder":"Find field",
"visualeditor-dialog-transclusion-loading":"Loading...","visualeditor-dialog-transclusion-more-template-description":"There might be some additional information about the \"$1\" template on [[$2|its page]].","visualeditor-dialog-transclusion-multipart-message":"You are currently editing a template and one or more pieces of connected content (wikitext and/or additional templates).","visualeditor-dialog-transclusion-no-parameters-description":"This template may be intended for use without [//www.mediawiki.org/wiki/Help:Templates#Parameters parameters]. If this template does contain parameters, they are [//www.mediawiki.org/wiki/Help:VisualEditor/User_guide#Template_parameters undocumented].","visualeditor-dialog-transclusion-no-template-data-description":
"This template is missing [//www.mediawiki.org/wiki/Help:VisualEditor/User_guide#Template_parameters TemplateData], and its parameters have been autogenerated. As a result the template and its parameters lack descriptions. There might be additional information on the [[$1|template's page]].","visualeditor-dialog-transclusion-no-template-description":"The \"$1\" template doesn't yet have a description, but there might be some information on the [[$2|template's page]].","visualeditor-dialog-transclusion-options":"Options","visualeditor-dialog-transclusion-param-default":"Default: $1","visualeditor-dialog-transclusion-param-example":"e.g. $1","visualeditor-dialog-transclusion-param-example-long":"Example: $1","visualeditor-dialog-transclusion-param-info":"Field description","visualeditor-dialog-transclusion-param-info-missing":"No field description available","visualeditor-dialog-transclusion-param-undocumented":"(Undocumented parameter)","visualeditor-dialog-transclusion-placeholder":
"Add a template","visualeditor-dialog-transclusion-raw-fallback":"Fall back to plain wikitext","visualeditor-dialog-transclusion-remove-content":"Remove content","visualeditor-dialog-transclusion-remove-param":"Remove field","visualeditor-dialog-transclusion-remove-template":"Remove template","visualeditor-dialog-transclusion-required-parameter":"Required field","visualeditor-dialog-transclusion-required-parameter-description":"Field is required.","visualeditor-dialog-transclusion-required-parameter-dialog-cancel":"Go back","visualeditor-dialog-transclusion-required-parameter-dialog-ok":"Continue anyway","visualeditor-dialog-transclusion-required-parameter-dialog-title":"Required {{PLURAL:$1|field|fields}} missing","visualeditor-dialog-transclusion-required-parameter-is-blank":"Are you sure you want to continue without filling the $1 {{PLURAL:$2|field|fields}}?","visualeditor-dialog-transclusion-reset-confirmation-cancel":"Continue editing",
"visualeditor-dialog-transclusion-reset-confirmation-message":"Going back will remove this template along with any information you have entered, returning you to the template selection. This action is irreversible.","visualeditor-dialog-transclusion-reset-confirmation-reset":"Remove template","visualeditor-dialog-transclusion-reset-confirmation-title":"Go back to search?","visualeditor-dialog-transclusion-see-template":"Templates are user-generated and may lack complete descriptions. There might be additional information on this [[$1|template's page]].","visualeditor-dialog-transclusion-suggestedvalues-warning":"This is not one of the suggested values and may not work with the template.","visualeditor-dialog-transclusion-template-search":"Template search","visualeditor-dialog-transclusion-template-search-help":"Find the template you want to insert by searching for an identifying keyword. Templates that have descriptions are more likely to work well with this editor (VisualEditor).",
"visualeditor-dialog-transclusion-templates-menu-aria-label":"Template fields setup menu","visualeditor-dialog-transclusion-title-edit-known-template":"Edit: $1","visualeditor-dialog-transclusion-title-edit-transclusion":"Template content","visualeditor-dialog-transclusion-title-insert-known-template":"Insert: $1","visualeditor-dialog-transclusion-title-insert-template":"Insert a template","visualeditor-dialog-transclusion-wikitext":"Wikitext","visualeditor-dialogbutton-template-tooltip":"Template","visualeditor-dialogbutton-transclusion-tooltip":"Transclusion","visualeditor-dismissible-message-close":"Close message and do not show again","visualeditor-expandable-less":"Less","visualeditor-expandable-more":"More","visualeditor-parameter-input-placeholder":"Field name","visualeditor-parameter-search-more":"Show {{PLURAL:$1|one more field|$1 more fields}}","visualeditor-parameter-search-no-unused":"No unused fields","visualeditor-parameter-search-unknown":"(Unknown field)"});